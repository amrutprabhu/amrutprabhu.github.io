<!DOCTYPE html><html lang="en"><head><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/icon.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/icon.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" content="#000000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');d.add('light');if("system"===e||(!e&&false)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="amrutprabhu" data-description="Support me on Buy me a coffee!" data-message="" data-color="#FFDD00" data-position="Right" data-x_margin="18" data-y_margin="18" strategy="afterInteractive" async=""></script><title>KStreams, Kafka Streams — Aggregate, Transform, and Join With Windowing using Spring Cloud Stream | RefactorFirst</title><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7490174059724719" crossorigin="anonymous"></script><meta name="robots" content="follow, index"/><meta name="description" content="In this article, we will explore Kstreams or Kafka Streams with aggregate, join, and windowing concepts using Spring Cloud Stream Kafka Streams"/><meta property="og:url" content="https://refactorfirst.com/spring-cloud-kafka-streams-aggregate-join-windowing"/><meta property="og:type" content="article"/><meta property="og:site_name" content="RefactorFirst"/><meta property="og:description" content="In this article, we will explore Kstreams or Kafka Streams with aggregate, join, and windowing concepts using Spring Cloud Stream Kafka Streams"/><meta property="og:title" content="KStreams, Kafka Streams — Aggregate, Transform, and Join With Windowing using Spring Cloud Stream"/><meta property="og:image" content="https://refactorfirst.com/static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/cover.jpg"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="https://twitter.com/amrutprabhu42"/><meta name="twitter:title" content="KStreams, Kafka Streams — Aggregate, Transform, and Join With Windowing using Spring Cloud Stream"/><meta name="twitter:description" content="In this article, we will explore Kstreams or Kafka Streams with aggregate, join, and windowing concepts using Spring Cloud Stream Kafka Streams"/><meta name="twitter:image" content="https://refactorfirst.com/static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/cover.jpg"/><meta property="article:published_time" content="2023-08-24T00:00:00.000Z"/><link rel="canonical" href="https://refactorfirst.com/spring-cloud-kafka-streams-aggregate-join-windowing"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://refactorfirst.com/spring-cloud-kafka-streams-aggregate-join-windowing"
  },
  "headline": "KStreams, Kafka Streams — Aggregate, Transform, and Join With Windowing using Spring Cloud Stream",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://refactorfirst.com/static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/cover.jpg"
    }
  ],
  "datePublished": "2023-08-24T00:00:00.000Z",
  "dateModified": "2023-08-24T00:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Amrut Prabhu"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Amrut Prabhu",
    "logo": {
      "@type": "ImageObject",
      "url": "https://refactorfirst.com/static/images/favicons/icon.png"
    }
  },
  "description": "In this article, we will explore Kstreams or Kafka Streams with aggregate, join, and windowing concepts using Spring Cloud Stream Kafka Streams"
}</script><meta name="next-head-count" content="22"/><link rel="preload" href="/_next/static/css/8e0c0b17a6c6bae5.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8e0c0b17a6c6bae5.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-cf23d9cda6584f61.js" defer=""></script><script src="/_next/static/chunks/main-a8532ea7c2505ecc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-e6b9cc79d27c0c8f.js" defer=""></script><script src="/_next/static/chunks/framework-327e104994690a53.js" defer=""></script><script src="/_next/static/chunks/207-4f91422181f853c0.js" defer=""></script><script src="/_next/static/chunks/102-159e13f5ec23a8df.js" defer=""></script><script src="/_next/static/chunks/956-7fff516e0356b1a4.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bslug%5D-000d2566608c9e90.js" defer=""></script><script src="/_next/static/DubunCy8_pPNL3TpgvJ0m/_buildManifest.js" defer=""></script><script src="/_next/static/DubunCy8_pPNL3TpgvJ0m/_ssgManifest.js" defer=""></script><script src="/_next/static/DubunCy8_pPNL3TpgvJ0m/_middlewareManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap">@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuGKYMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuFuYMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body class="antialiased text-black bg-white dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-6xl xl:px-0"><div class="flex flex-col justify-between h-screen"><header class="flex items-center justify-between py-10"><div><a aria-label="RefactorFirst" href="/"><div class="flex items-center justify-between"><div class="mr-3"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmVyc2lvbj0iMS4xIi8+"/></span><img alt="RefactorFirst" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="RefactorFirst" srcSet="static/favicons/icon.png?imwidth=64 1x, static/favicons/icon.png?imwidth=128 2x" src="static/favicons/icon.png?imwidth=128" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div><div class="h-6 text-2xl font-semibold sm:block">RefactorFirst</div></div></a></div><div class="mt-6"></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/tags">Tags</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/posts">Posts</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/about">About</a></div><button aria-label="Toggle Dark Mode" type="button" class="w-8 h-8 p-1 ml-1 mr-1 rounded sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="w-8 h-8 py-1 ml-1 mr-1 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed w-full h-full top-24 right-0 bg-gray-200 dark:bg-gray-800 opacity-95 z-10 transform ease-in-out duration-300 translate-x-full"><button type="button" aria-label="toggle modal" class="fixed w-full h-full cursor-auto focus:outline-none"></button><nav class="fixed h-full mt-8"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/posts">Posts</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/about">About</a></div></nav></div></div></div></header><main class="mb-auto"><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-6xl xl:px-0"><div class="fixed flex-col hidden gap-3 right-8 bottom-8 md:flex"><button aria-label="Scroll To Top" type="button" style="opacity:0" class="p-2 text-gray-500 transition-all bg-gray-200 rounded-full dark:text-gray-400 dark:bg-gray-700 dark:hover:bg-gray-600 hover:bg-gray-300"><svg class="w-5 h-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-100"><time dateTime="2023-08-24T00:00:00.000Z">Thursday, August 24, 2023</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">KStreams, Kafka Streams — Aggregate, Transform, and Join With Windowing using Spring Cloud Stream</h1><div class="mt-6"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNzQ0IiBoZWlnaHQ9IjQwNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2ZXJzaW9uPSIxLjEiLz4="/></span><img alt="KStreams, Kafka Streams — Aggregate, Transform, and Join With Windowing using Spring Cloud Stream" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="object-cover object-center lg:h-48 md:h-36 rounded-2xl" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="KStreams, Kafka Streams — Aggregate, Transform, and Join With Windowing using Spring Cloud Stream" srcSet="static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/cover.jpg?imwidth=750 1x, static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/cover.jpg?imwidth=1920 2x" src="static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/cover.jpg?imwidth=1920" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="object-cover object-center lg:h-48 md:h-36 rounded-2xl" loading="lazy"/></noscript></span></div><div class="text-primary-500 hover:text-primary-600 text-md dark:hover:text-primary-400"><div></div></div><div class="mt-2 text-gray-500 dark:text-gray-100">13 min read</div></div></div></header><div class="pb-8 divide-y divide-gray-200 xl:divide-y-0 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:pt-11 xl:border-b xl:border-gray-200 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 xl:block sm:space-x-12 xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzgiIGhlaWdodD0iMzgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmVyc2lvbj0iMS4xIi8+"/></span><img alt="avatar" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="w-10 h-10 rounded-full" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="avatar" srcSet="static/images/avatar-small.jpg?imwidth=48 1x, static/images/avatar-small.jpg?imwidth=96 2x" src="static/images/avatar-small.jpg?imwidth=96" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="w-10 h-10 rounded-full" loading="lazy"/></noscript></span><dl class="text-sm font-medium leading-5 whitespace-nowrap"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">Amrut Prabhu</dd><dt class="sr-only">Twitter</dt><dd><a target="_blank" rel="noopener noreferrer" href="https://twitter.com/amrutprabhu42" class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400">@amrutprabhu42</a></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:pb-0 xl:col-span-3 xl:row-span-2"><div class="pt-10 pb-8 prose text-lg leading-8 dark:prose-dark max-w-none"><div></div><div><h3 id="kstreams-kafka-streamsaggregate-transform-and-join-using-spring-cloud-stream"><a href="#kstreams-kafka-streamsaggregate-transform-and-join-using-spring-cloud-stream" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>KStreams, Kafka Streams — Aggregate, Transform, and Join using Spring Cloud Stream</h3>
<p>In this article, we will explore Kstreams or Kafka Streams with aggregate, join, and windowing concepts using Spring Cloud Stream Kafka Streams</p>
<h2 id="creating-a-project-with-spring-cloud-streams"><a href="#creating-a-project-with-spring-cloud-streams" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Creating a project with Spring Cloud Streams</h2>
<p>Go to <a target="_blank" rel="noopener noreferrer" href="https://start.spring.io">https://start.spring.io</a> and add the following dependencies</p>
<ul>
<li>Cloud Stream</li>
<li>Spring For Apache Kafka</li>
<li>Spring For Apache Kafka Streams</li>
</ul>
<p>The goal will be to create a pipeline like the one below to explore various concepts like transformation, aggregation, and joining in KStreams or Kafka Streams.</p>
<div><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTM0OCIgaGVpZ2h0PSI0NDciIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmVyc2lvbj0iMS4xIi8+"/></span><img alt="kafka-streams-pipeline-example" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="kafka-streams-pipeline-example" srcSet="static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/kafka-streams-pipeline-example.png?imwidth=1920 1x, static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/kafka-streams-pipeline-example.png?imwidth=3840 2x" src="static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/kafka-streams-pipeline-example.png?imwidth=3840" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div>
<p>So first let’s create the producer that will send messages to the Kafka Topic <code>first-topic</code> every second.</p>
<p>You can refer to the entire code on my GitHub Repo <a target="_blank" rel="noopener noreferrer" href="https://github.com/amrutprabhu/kafka-workouts/tree/master/spring-cloud-stream-kafka-streams-with-kstreams">here</a>.</p>
<h2 id="creating-a-kafka-publisher-with-spring-cloud-stream-kafka"><a href="#creating-a-kafka-publisher-with-spring-cloud-stream-kafka" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Creating a Kafka Publisher with Spring Cloud Stream Kafka</h2>
<p>Spring Cloud Stream makes use of functional interfaces from <code>java.util.function</code> package to define producers and consumers.</p>
<p>Hence we will create a simple supplier bean that will supply values as a producer.</p>
<div class="relative"><pre><code class="language-java code-highlight"><span class="code-line"> <span class="token annotation punctuation">@Bean</span>
</span><span class="code-line">    <span class="token keyword">public</span> <span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>messaging<span class="token punctuation">.</span></span>Message</span><span class="token punctuation">&lt;</span><span class="token class-name">MyEvent</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">producer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">            <span class="token comment">// random department</span>
</span><span class="code-line">            <span class="token class-name">Department</span> department <span class="token operator">=</span> <span class="token class-name">Department</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token class-name">Department</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">            <span class="token comment">// Event playload</span>
</span><span class="code-line">            <span class="token class-name">MyEvent</span> myEvent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyEvent</span><span class="token punctuation">(</span><span class="token string">&quot;Jack&quot;</span><span class="token punctuation">,</span> department<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">            <span class="token keyword">return</span> <span class="token class-name">MessageBuilder</span><span class="token punctuation">.</span><span class="token function">withPayload</span><span class="token punctuation">(</span>myEvent<span class="token punctuation">)</span>
</span><span class="code-line">                    <span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token class-name">KafkaHeaders</span><span class="token punctuation">.</span>KEY<span class="token punctuation">,</span> department<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span></code></pre></div>
<p>Here I am creating a producer that will send a message called MyEvent which has a name and department that will be chosen randomly.</p>
<p>Here, the message key is the department and we wrap the payload using the MessageBuilder from Spring.</p>
<div class="adsbygoogle-adflow1"><ins class="adsbygoogle" style="display:block;text-align:center" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-7490174059724719" data-ad-slot="8168941152" id="adflow1"></ins></div>
<p>This is how we can create a simple producer that produces a message every second.</p>
<p>Now, let&#x27;s look at the properties required for this.</p>
<div class="relative"><pre><code class="language-yaml code-highlight"><span class="code-line"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token key atrule">function</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">definition</span><span class="token punctuation">:</span> producer
</span><span class="code-line">    <span class="token key atrule">stream</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">kafka</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">binder</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">brokers</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">9092</span>
</span><span class="code-line">        <span class="token key atrule">bindings</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">producer-out-0</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token key atrule">producer</span><span class="token punctuation">:</span>
</span><span class="code-line">              <span class="token key atrule">configuration</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token key atrule">key.serializer</span><span class="token punctuation">:</span> org.apache.kafka.common.serialization.StringSerializer
</span><span class="code-line">      <span class="token key atrule">bindings</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">producer-out-0</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">destination</span><span class="token punctuation">:</span> first<span class="token punctuation">-</span>topic
</span></code></pre></div>
<p>Here we set three things:</p>
<ul>
<li><strong>The Binding</strong>: This registers the binding function’s parameter.</li>
<li><strong>The producer configuration</strong>: To specify the key serializer.</li>
<li><strong>The Spring Cloud Function definition</strong>: This is the bean definition of binding.</li>
</ul>
<p>You can read this article <a target="_blank" rel="noopener noreferrer" href="https://refactorfirst.com/spring-cloud-stream-with-kafka-communication">here</a>, wherein I explain in detail how these properties are set, what is the meaning of the <code>-out-</code> property, and how the bindings work.</p>
<p>I would recommend reading it as it will make it easier to understand the next section in which we will be exploring how we can deal with Kafka Streams or KStreams</p>
<h2 id="creating-a-kstream-or-kafka-stream-transformation"><a href="#creating-a-kstream-or-kafka-stream-transformation" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Creating a KStream or Kafka Stream Transformation</h2>
<p>Let’s consider we want to create a handler that will transfer an input stream and send it out to another Kafka Stream</p>
<p>So our producer above is emitting events and now we will transform them and send them to a new topic.</p>
<p>Now the transformation is as simple as defining the following functional bean.</p>
<div class="relative"><pre><code class="language-java code-highlight"><span class="code-line"> <span class="token annotation punctuation">@Bean</span>
</span><span class="code-line">    <span class="token keyword">public</span> <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">KStream</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">MyEvent</span><span class="token punctuation">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">KStream</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">enhancer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">return</span> input <span class="token operator">-&gt;</span> input
</span><span class="code-line">                <span class="token punctuation">.</span><span class="token function">mapValues</span><span class="token punctuation">(</span>value <span class="token operator">-&gt;</span> value<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span></code></pre></div>
<p>It just takes the input and transforms it by mapping the value which was originally a JSON object to the name inside the JSON Object.</p>
<p>Next, we need to configure the enhancer in the properties file.</p>
<div class="relative"><pre><code class="language-yaml code-highlight"><span class="code-line"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token key atrule">function</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">definition</span><span class="token punctuation">:</span> producer;enhancer
</span><span class="code-line">    <span class="token key atrule">stream</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">kafka</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">streams</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">bindings</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token key atrule">enhancer-in-0</span><span class="token punctuation">:</span> <span class="token comment">#   only required if you need to provide some configurations.</span>
</span><span class="code-line">              <span class="token key atrule">consumer</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token key atrule">keySerde</span><span class="token punctuation">:</span> org.apache.kafka.common.serialization.Serdes$StringSerde
</span><span class="code-line">                <span class="token key atrule">valueSerde</span><span class="token punctuation">:</span> com.amrut.prabhu.dto.coverters.MyEventSerDes <span class="token comment">#custom</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="token key atrule">binder</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">brokers</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">9092</span>
</span><span class="code-line">        <span class="token key atrule">bindings</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">producer-out-0</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token key atrule">producer</span><span class="token punctuation">:</span>
</span><span class="code-line">              <span class="token key atrule">configuration</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token key atrule">key.serializer</span><span class="token punctuation">:</span> org.apache.kafka.common.serialization.StringSerializer
</span><span class="code-line">      <span class="token key atrule">bindings</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">producer-out-0</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">destination</span><span class="token punctuation">:</span> first<span class="token punctuation">-</span>topic
</span><span class="code-line">
</span><span class="code-line">        <span class="token key atrule">enhancer-in-0</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">destination</span><span class="token punctuation">:</span> first<span class="token punctuation">-</span>topic
</span><span class="code-line">        <span class="token key atrule">enhancer-out-0</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">destination</span><span class="token punctuation">:</span> second<span class="token punctuation">-</span>topic
</span></code></pre></div>
<p>Here, we do three things.</p>
<ul>
<li>We specify the binding for our enhancer. We specify the topics from which we want to read and write messages to</li>
<li>Our Spring Cloud function definition i.e. enhancer</li>
<li>And finally the key and value serializer and deserializer in the Kafka Streams bindings.</li>
</ul>
<p>So here we are creating our custom value serializer which is a simple Json serializer deserializer.</p>
<div class="relative"><pre><code class="language-java code-highlight"><span class="code-line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyEventSerDes</span> <span class="token keyword">extends</span> <span class="token class-name">JsonSerde</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MyEvent</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div>
<p>Make sure you look at the properties carefully, as they can be confused with the properties defined under <code>spring.cloud.stream.kafka</code></p>
<p>The serializer and deserializer properties are defined under the <code>spring.cloud.stream.kafka.streams</code> umbrella.</p>
<p>So be careful about it.</p>
<p>With this, the input KStream or Kafka Stream coming from the topic <code>first-topic</code>looks like this:</p>
<div><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQ2MiIgaGVpZ2h0PSIyNDgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmVyc2lvbj0iMS4xIi8+"/></span><img alt="first-kafka-stream-output" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="first-kafka-stream-output" srcSet="static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/first-kafka-stream-output.webp?imwidth=1920 1x, static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/first-kafka-stream-output.webp?imwidth=3840 2x" src="static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/first-kafka-stream-output.webp?imwidth=3840" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div>
<p>While the output sent to the topic <code>second-topic</code> looks like this:</p>
<div><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTE0NiIgaGVpZ2h0PSIyMjIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmVyc2lvbj0iMS4xIi8+"/></span><img alt="second-kafka-stream-output" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="second-kafka-stream-output" srcSet="static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/second-kafka-stream-output.webp?imwidth=1200 1x, static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/second-kafka-stream-output.webp?imwidth=3840 2x" src="static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/second-kafka-stream-output.webp?imwidth=3840" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div>
<p>The images above is using the following format to show the contents of the Kafka topic.</p>
<div class="relative"><pre><code class="language-shell code-highlight"><span class="code-line">Partition: <span class="token operator">&lt;</span>Topic partition number<span class="token operator">&gt;</span> <span class="token builtin class-name">:</span> Offset: <span class="token operator">&lt;</span>Topic offset<span class="token operator">&gt;</span> <span class="token builtin class-name">:</span> <span class="token operator">&lt;</span>Key<span class="token operator">&gt;</span> <span class="token builtin class-name">:</span> <span class="token operator">&lt;</span>Value<span class="token operator">&gt;</span>
</span></code></pre></div>
<p>We will be using the same format to view the messages in the topics as we go ahead.</p>
<p>Now let’s look at how we can aggregate data from one stream and send it to another.</p>
<h2 id="aggregate-data-from-kstream-or-kafka-stream-with-windowing"><a href="#aggregate-data-from-kstream-or-kafka-stream-with-windowing" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Aggregate Data From KStream Or Kafka Stream With Windowing</h2>
<p>Let’s aggregate data from the <code>first-topic</code> for a time window of 10 seconds and send it over to a <code>third-topic</code> .</p>
<div class="relative"><pre><code class="language-java code-highlight"><span class="code-line"> <span class="token annotation punctuation">@Bean</span>
</span><span class="code-line">    <span class="token keyword">public</span> <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">KStream</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">MyEvent</span><span class="token punctuation">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">KStream</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">return</span> input <span class="token operator">-&gt;</span> input
</span><span class="code-line">
</span><span class="code-line">                <span class="token punctuation">.</span><span class="token function">groupByKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">                <span class="token punctuation">.</span><span class="token function">windowedBy</span><span class="token punctuation">(</span><span class="token class-name">TimeWindows</span><span class="token punctuation">.</span><span class="token function">ofSizeWithNoGrace</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">                <span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token number">0l</span><span class="token punctuation">,</span>
</span><span class="code-line">                        <span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> aggregate<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> aggregate <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
</span><span class="code-line">                        <span class="token class-name">Materialized</span><span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token class-name">Serdes<span class="token punctuation">.</span>String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Serdes<span class="token punctuation">.</span>Long</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">                <span class="token punctuation">.</span><span class="token function">suppress</span><span class="token punctuation">(</span><span class="token class-name">Suppressed</span><span class="token punctuation">.</span><span class="token function">untilWindowCloses</span><span class="token punctuation">(</span><span class="token class-name">Suppressed<span class="token punctuation">.</span>BufferConfig</span><span class="token punctuation">.</span><span class="token function">unbounded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">                <span class="token punctuation">.</span><span class="token function">toStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> v<span class="token punctuation">)</span> <span class="token operator">-&gt;</span>  <span class="token keyword">new</span> <span class="token class-name">KeyValue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>w<span class="token punctuation">.</span><span class="token function">key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token punctuation">}</span>
</span></code></pre></div>
<p>Here we first group the data by the key within a window size of 10 seconds.</p>
<p>In the aggregate function, the first parameter is the initial value of 0 for the aggregate. The second parameter is an aggregate function that increments by 1 for every value with the same key in the 10-second window (simulating a count aggregation)</p>
<p>The final parameter is used to specify the serializer and deserializer to materialize the results of the time window in an intermediate topic.</p>
<p>After the aggregate function, we have to specify the suppression, or else the intermediate values during the aggregation window will be sent out to the output topic.</p>
<p>Now, let&#x27;s look at the properties.</p>
<div class="relative"><pre><code class="language-yaml code-highlight"><span class="code-line"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token key atrule">function</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">definition</span><span class="token punctuation">:</span> producer;enhancer;aggregate
</span><span class="code-line">    <span class="token key atrule">stream</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">kafka</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">streams</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">bindings</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token key atrule">enhancer-in-0</span><span class="token punctuation">:</span> <span class="token comment">#   only required if you need to provide some configurations.</span>
</span><span class="code-line">              <span class="token key atrule">consumer</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token key atrule">keySerde</span><span class="token punctuation">:</span> org.apache.kafka.common.serialization.Serdes$StringSerde
</span><span class="code-line">                <span class="token key atrule">valueSerde</span><span class="token punctuation">:</span> com.amrut.prabhu.dto.coverters.MyEventSerDes <span class="token comment">#custom</span>
</span><span class="code-line">
</span><span class="code-line">            <span class="token key atrule">aggregate-in-0</span><span class="token punctuation">:</span>
</span><span class="code-line">              <span class="token key atrule">consumer</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token key atrule">keySerde</span><span class="token punctuation">:</span> org.apache.kafka.common.serialization.Serdes$StringSerde
</span><span class="code-line">                <span class="token key atrule">valueSerde</span><span class="token punctuation">:</span> com.amrut.prabhu.dto.coverters.MyEventSerDes <span class="token comment">#custom</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="token key atrule">binder</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">brokers</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">9092</span>
</span><span class="code-line">        <span class="token key atrule">bindings</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">producer-out-0</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token key atrule">producer</span><span class="token punctuation">:</span>
</span><span class="code-line">              <span class="token key atrule">configuration</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token key atrule">key.serializer</span><span class="token punctuation">:</span> org.apache.kafka.common.serialization.StringSerializer
</span><span class="code-line">      <span class="token key atrule">bindings</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">producer-out-0</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">destination</span><span class="token punctuation">:</span> first<span class="token punctuation">-</span>topic
</span><span class="code-line">
</span><span class="code-line">        <span class="token key atrule">enhancer-in-0</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">destination</span><span class="token punctuation">:</span> first<span class="token punctuation">-</span>topic
</span><span class="code-line">        <span class="token key atrule">enhancer-out-0</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">destination</span><span class="token punctuation">:</span> second<span class="token punctuation">-</span>topic
</span><span class="code-line">        <span class="token comment">#</span>
</span><span class="code-line">        <span class="token key atrule">aggregate-in-0</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">destination</span><span class="token punctuation">:</span> first<span class="token punctuation">-</span>topic
</span><span class="code-line">        <span class="token key atrule">aggregate-out-0</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">destination</span><span class="token punctuation">:</span> third<span class="token punctuation">-</span>topic
</span></code></pre></div>
<p>Here we also provide three things.</p>
<ul>
<li>The binding specifies the input and output topic.</li>
<li>The binding function definition under the property <code>spring.cloud.function.definiton</code></li>
<li>Finally the consumer properties under <code>spring.cloud.stream.kafka.streams</code> specifying the key and value serializer and deserializer.</li>
</ul>
<p>With this, the data will be produced every 10 seconds on the <code>third-topic</code> as shown below.</p>
<div><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTM4MCIgaGVpZ2h0PSI1NzYiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmVyc2lvbj0iMS4xIi8+"/></span><img alt="third-kafka-stream-aggregate-output" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="third-kafka-stream-aggregate-output" srcSet="static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/third-kafka-stream-aggregate-output.webp?imwidth=1920 1x, static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/third-kafka-stream-aggregate-output.webp?imwidth=3840 2x" src="static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/third-kafka-stream-aggregate-output.webp?imwidth=3840" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div>
<p>So this is the aggregated count per key in a time window of 10 seconds.</p>
<p>With this let’s look at how we can join data from the <code>second-topic</code> and the <code>third-topic</code> and produce the joined value in the <code>fourth-topic</code> .</p>
<h2 id="using-join-on-kstreams-or-kafka-streams-with-windowing"><a href="#using-join-on-kstreams-or-kafka-streams-with-windowing" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Using Join On KStreams or Kafka Streams with Windowing</h2>
<p>To create a Join of two Kafka Streams we will make use of a Bifunction.</p>
<div class="relative"><pre><code class="language-Java code-highlight"><span class="code-line"> <span class="token annotation punctuation">@Bean</span>
</span><span class="code-line">    <span class="token keyword">public</span> <span class="token class-name">BiFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">KStream</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">KStream</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">KStream</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">JoinedValue</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token punctuation">(</span>input1<span class="token punctuation">,</span> input2<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> input1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>input2<span class="token punctuation">,</span>
</span><span class="code-line">                <span class="token punctuation">(</span>value1<span class="token punctuation">,</span> value2<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token class-name">JoinedValue</span><span class="token punctuation">(</span>value1<span class="token punctuation">,</span> value2<span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">                <span class="token class-name">JoinWindows</span><span class="token punctuation">.</span><span class="token function">ofTimeDifferenceWithNoGrace</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token class-name">ChronoUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">                <span class="token class-name">StreamJoined</span><span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token class-name">Serdes<span class="token punctuation">.</span>String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">Serdes<span class="token punctuation">.</span>String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">Serdes<span class="token punctuation">.</span>String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">                <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token punctuation">}</span>
</span></code></pre></div>
<p>In the function above, we take the messages from the <code>second-topic</code> and join them directly with the messages from the <code>third-topic</code> for a time window of 10 seconds resulting in a cartesian product.</p>
<p>Every message will be combined with a message from the other topic based on the key. This will result in an output just like a full join in SQL.</p>
<p>Let’s look at the properties.</p>
<div class="relative"><pre><code class="language-yaml code-highlight"><span class="code-line"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token key atrule">function</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">definition</span><span class="token punctuation">:</span> producer;enhancer;aggregate;join
</span><span class="code-line">    <span class="token key atrule">stream</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">kafka</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">streams</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">bindings</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token key atrule">enhancer-in-0</span><span class="token punctuation">:</span> <span class="token comment">#   only required if you need to provide some configurations.</span>
</span><span class="code-line">              <span class="token key atrule">consumer</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token key atrule">keySerde</span><span class="token punctuation">:</span> org.apache.kafka.common.serialization.Serdes$StringSerde
</span><span class="code-line">                <span class="token key atrule">valueSerde</span><span class="token punctuation">:</span> com.amrut.prabhu.dto.coverters.MyEventSerDes <span class="token comment">#custom</span>
</span><span class="code-line">            <span class="token key atrule">aggregate-in-0</span><span class="token punctuation">:</span>
</span><span class="code-line">              <span class="token key atrule">consumer</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token key atrule">keySerde</span><span class="token punctuation">:</span> org.apache.kafka.common.serialization.Serdes$StringSerde
</span><span class="code-line">                <span class="token key atrule">valueSerde</span><span class="token punctuation">:</span> com.amrut.prabhu.dto.coverters.MyEventSerDes <span class="token comment">#custom</span>
</span><span class="code-line">            <span class="token key atrule">join-out-0</span><span class="token punctuation">:</span>
</span><span class="code-line">              <span class="token key atrule">producer</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token key atrule">keySerde</span><span class="token punctuation">:</span> org.apache.kafka.common.serialization.Serdes$StringSerde
</span><span class="code-line">                <span class="token key atrule">valueSerde</span><span class="token punctuation">:</span> com.amrut.prabhu.dto.coverters.JoinedValueSerDes
</span><span class="code-line">
</span><span class="code-line">        <span class="token key atrule">binder</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">brokers</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">9092</span>
</span><span class="code-line">        <span class="token key atrule">bindings</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">producer-out-0</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token key atrule">producer</span><span class="token punctuation">:</span>
</span><span class="code-line">              <span class="token key atrule">configuration</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token key atrule">key.serializer</span><span class="token punctuation">:</span> org.apache.kafka.common.serialization.StringSerializer
</span><span class="code-line">      <span class="token key atrule">bindings</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">producer-out-0</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">destination</span><span class="token punctuation">:</span> first<span class="token punctuation">-</span>topic
</span><span class="code-line">
</span><span class="code-line">        <span class="token key atrule">enhancer-in-0</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">destination</span><span class="token punctuation">:</span> first<span class="token punctuation">-</span>topic
</span><span class="code-line">        <span class="token key atrule">enhancer-out-0</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">destination</span><span class="token punctuation">:</span> second<span class="token punctuation">-</span>topic
</span><span class="code-line">        <span class="token comment">#</span>
</span><span class="code-line">        <span class="token key atrule">aggregate-in-0</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">destination</span><span class="token punctuation">:</span> first<span class="token punctuation">-</span>topic
</span><span class="code-line">        <span class="token key atrule">aggregate-out-0</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">destination</span><span class="token punctuation">:</span> third<span class="token punctuation">-</span>topic
</span><span class="code-line">        <span class="token comment">#</span>
</span><span class="code-line">        <span class="token key atrule">join-in-0</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">destination</span><span class="token punctuation">:</span> second<span class="token punctuation">-</span>topic
</span><span class="code-line">        <span class="token key atrule">join-in-1</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">destination</span><span class="token punctuation">:</span> third<span class="token punctuation">-</span>topic
</span><span class="code-line">        <span class="token key atrule">join-out-0</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token key atrule">destination</span><span class="token punctuation">:</span> fourth<span class="token punctuation">-</span>topic
</span></code></pre></div>
<p>Here, if you look carefully, in the binding we specify two inputs and one output.</p>
<p>The rest is the same as adding the function definition and the serializer and deserializer properties as we did for the other bindings above.</p>
<p>When we run this, it produces the following messages on the <code>fourth-topic</code></p>
<div><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTMyNCIgaGVpZ2h0PSI3MDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmVyc2lvbj0iMS4xIi8+"/></span><img alt="fourth-kafka-stream-join-output" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="fourth-kafka-stream-join-output" srcSet="static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/fourth-kafka-stream-join-output.webp?imwidth=1920 1x, static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/fourth-kafka-stream-join-output.webp?imwidth=3840 2x" src="static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/fourth-kafka-stream-join-output.webp?imwidth=3840" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div>
<p>You can refer to the entire code on my GitHub Repo <a target="_blank" rel="noopener noreferrer" href="https://github.com/amrutprabhu/kafka-workouts/tree/master/spring-cloud-stream-kafka-streams-with-kstreams">here</a>.</p>
<p>If you are interested in learning more about Java and Spring Boot, here are some interesting articles to look at.</p>
<ul>
<li><a target="_blank" rel="noopener noreferrer" href="https://refactorfirst.com/spring-boot-3-with-docker-compose-support"><strong>Spring Boot 3.1 Docker Compose Support</strong></a></li>
<li><a target="_blank" rel="noopener noreferrer" href="https://refactorfirst.com/defining-event-driven-achitectures-asyncapi"><strong>Defining Event-Driven Architectures — AsyncAPI</strong></a></li>
<li><a target="_blank" rel="noopener noreferrer" href="https://refactorfirst.com/how-does-fido2-passwordless-authentication-work"><strong>FIDO2 Passwordless Authentication With KeyCloak</strong></a></li>
</ul>
<p>I keep exploring and learning new things. If you want to know the latest trends and improve your software development skills, then subscribe to my newsletter below and also follow me on <a target="_blank" rel="noopener noreferrer" href="https://twitter.com/amrutprabhu42">Twitter</a>.</p>
<p>Enjoy!!</p></div><div><div><button type="button" class="text-white bg-[#3b5998] hover:bg-[#3b5998]/90 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center mr-2 mb-2"><svg class="w-4 h-4 mr-2 -ml-1" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="facebook-f" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"></path></svg></svg>Share</button><button type="button" class="text-white bg-[#1da1f2] hover:bg-[#1da1f2]/90 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center mr-2 mb-2"><svg class="w-4 h-4 mr-2 -ml-1" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="twitter" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current"><path d="M23.953 4.57a10 10 0 0 1-2.825.775 4.958 4.958 0 0 0 2.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 0 0-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 0 0-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 0 1-2.228-.616v.06a4.923 4.923 0 0 0 3.946 4.827 4.996 4.996 0 0 1-2.212.085 4.936 4.936 0 0 0 4.604 3.417 9.867 9.867 0 0 1-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 0 0 7.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0 0 24 4.59z"></path></svg></svg>Tweet</button><button type="button" class="text-white bg-[#0077B5] hover:bg-[#00A0DC]/90 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center mr-2 mb-2"><svg class="w-4 h-4 mr-2 -ml-1" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></svg>Post</button><button type="button" class="text-white bg-[#4285F4] hover:bg-[#4285F4]/90 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center mr-2 mb-2"><svg class="w-4 h-4 mr-2 -ml-1" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="email" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></svg>Share</button></div></div></div><hr/></div><footer><div class="text-sm font-medium leading-5 divide-gray-200 xl:divide-y dark:divide-gray-700 xl:col-start-1 xl:row-start-2"><div class="py-4 xl:py-8"><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="m-1 p-1 px-2 leading-4 h-6 rounded text-xs uppercase text-white bg-teal-500 hover:bg-teal-400 dark:hover:bg-teal-500 dark:bg-teal-600" href="/tags/java">Java</a><a class="m-1 p-1 px-2 leading-4 h-6 rounded text-xs uppercase text-white bg-teal-500 hover:bg-teal-400 dark:hover:bg-teal-500 dark:bg-teal-600" href="/tags/spring-boot">Spring Boot</a><a class="m-1 p-1 px-2 leading-4 h-6 rounded text-xs uppercase text-white bg-teal-500 hover:bg-teal-400 dark:hover:bg-teal-500 dark:bg-teal-600" href="/tags/kakfa">Kakfa</a><a class="m-1 p-1 px-2 leading-4 h-6 rounded text-xs uppercase text-white bg-teal-500 hover:bg-teal-400 dark:hover:bg-teal-500 dark:bg-teal-600" href="/tags/spring-cloud-stream">Spring cloud Stream</a><a class="m-1 p-1 px-2 leading-4 h-6 rounded text-xs uppercase text-white bg-teal-500 hover:bg-teal-400 dark:hover:bg-teal-500 dark:bg-teal-600" href="/tags/kstream">Kstream</a><a class="m-1 p-1 px-2 leading-4 h-6 rounded text-xs uppercase text-white bg-teal-500 hover:bg-teal-400 dark:hover:bg-teal-500 dark:bg-teal-600" href="/tags/kafka-stream">kafka stream</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/spring-boot-with-redis-stack-and-redis-insight">How to Search &amp; Query Redis with A Spring Boot Application</a></div></div></div></div><div class="pt-4 xl:pt-8 xl:mb-8 mb-4"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/">← Back to the articles</a></div><div class="hidden xl:block"><div class="border-2 border-teal-500 rounded-lg p-1"><div><a target="_blank" rel="noopener noreferrer" href="https://www.copecart.com/products/521411d4/p/techapk42"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA1NCIgaGVpZ2h0PSIyMTAwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIvPg=="/></span><img alt="title" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="object-cover object-center " style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="title" srcSet="/static/images/promotion/testing-spring-boot-applications-masterclass-architecture-524x733.png?imwidth=1080 1x, /static/images/promotion/testing-spring-boot-applications-masterclass-architecture-524x733.png?imwidth=3840 2x" src="/static/images/promotion/testing-spring-boot-applications-masterclass-architecture-524x733.png?imwidth=3840" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="object-cover object-center " loading="lazy"/></noscript></span></a></div></div></div></footer></div></div></article></div></main><div class="ml-embedded" data-form="rRtdd0"></div><footer><div class="flex flex-col items-center mt-16"><div class="flex mb-3 space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:contact@refactorfirst.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/amrutprabhu"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/amrut-prabhu-722baa65/"><span class="sr-only">linkedin</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://twitter.com/amrutprabhu42"><span class="sr-only">twitter</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M23.953 4.57a10 10 0 0 1-2.825.775 4.958 4.958 0 0 0 2.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 0 0-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 0 0-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 0 1-2.228-.616v.06a4.923 4.923 0 0 0 3.946 4.827 4.996 4.996 0 0 1-2.212.085 4.936 4.936 0 0 0 4.604 3.417 9.867 9.867 0 0 1-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 0 0 7.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0 0 24 4.59z"></path></svg></a></div><div class="flex mb-2 space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Amrut Prabhu</div><div> • </div><div>© 2023</div><div> • </div><a href="/">RefactorFirst</a><div> • </div><a href="/privacy">Privacy Policy</a></div><br/></div></footer></div></div><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-6xl xl:px-0"><div id="cookie-notice" class="consent_consentname__aF_O7"><br/><br/><p>By clicking “I Accept”, you agree to the storing of cookies on your device to enhance site navigation and analyze site usage</p><br/><br/><div><a id="cookie-notice-accept" class="consent_greenButton__K0FRN">I Accept</a><a href="/privacy">Privacy Policy</a></div><br/><br/><br/></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var h=Object.create;var l=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var k=Object.getPrototypeOf,N=Object.prototype.hasOwnProperty;var o=a=\u003el(a,\"__esModule\",{value:!0});var g=(a,s)=\u003e()=\u003e(s||a((s={exports:{}}).exports,s),s.exports),f=(a,s)=\u003e{o(a);for(var c in s)l(a,c,{get:s[c],enumerable:!0})},y=(a,s,c)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let e of m(s))!N.call(a,e)\u0026\u0026e!==\"default\"\u0026\u0026l(a,e,{get:()=\u003es[e],enumerable:!(c=u(s,e))||c.enumerable});return a},w=a=\u003ey(o(l(a!=null?h(k(a)):{},\"default\",a\u0026\u0026a.__esModule\u0026\u0026\"default\"in a?{get:()=\u003ea.default,enumerable:!0}:{value:a,enumerable:!0})),a);var d=g((z,r)=\u003e{r.exports=_jsx_runtime});var j={};f(j,{default:()=\u003ev,frontmatter:()=\u003eS});var n=w(d()),S={title:\"KStreams, Kafka Streams \\u2014 Aggregate, Transform, and Join With Windowing using Spring Cloud Stream\",author:\"Amrut Prabhu\",categories:\"\",tags:[\"Java\",\"Spring Boot\",\"Kakfa\",\"Spring cloud Stream\",\"Kstream\",\"kafka stream\"],\"photo-credits\":null,\"applaud-link\":\"2021/spring-boot-stream-kafka.json\",date:\"2023-08-24\",draft:!1,summary:\"In this article, we will explore Kstreams or Kafka Streams with aggregate, join, and windowing concepts using Spring Cloud Stream Kafka Streams\",imageUrl:\"/static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/cover.jpg\",actualUrl:\"auto-generated\",customUrl:\"auto-generated\"};function b(a={}){let{wrapper:s}=a.components||{};return s?(0,n.jsx)(s,Object.assign({},a,{children:(0,n.jsx)(c,{})})):c();function c(){let e=Object.assign({h3:\"h3\",a:\"a\",span:\"span\",p:\"p\",h2:\"h2\",ul:\"ul\",li:\"li\",div:\"div\",code:\"code\",pre:\"pre\",strong:\"strong\"},a.components),{Image:t,AdsFlows:i}=e;return i||p(\"AdsFlows\",!0),t||p(\"Image\",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h3,{id:\"kstreams-kafka-streamsaggregate-transform-and-join-using-spring-cloud-stream\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#kstreams-kafka-streamsaggregate-transform-and-join-using-spring-cloud-stream\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"KStreams, Kafka Streams\\u200A\\u2014\\u200AAggregate, Transform, and Join using Spring Cloud Stream\"]}),`\n`,(0,n.jsx)(e.p,{children:\"In this article, we will explore Kstreams or Kafka Streams with aggregate, join, and windowing concepts using Spring Cloud Stream Kafka Streams\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"creating-a-project-with-spring-cloud-streams\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#creating-a-project-with-spring-cloud-streams\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Creating a project with Spring Cloud Streams\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Go to \",(0,n.jsx)(e.a,{href:\"https://start.spring.io\",children:\"https://start.spring.io\"}),\" and add the following dependencies\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Cloud Stream\"}),`\n`,(0,n.jsx)(e.li,{children:\"Spring For Apache Kafka\"}),`\n`,(0,n.jsx)(e.li,{children:\"Spring For Apache Kafka Streams\"}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"The goal will be to create a pipeline like the one below to explore various concepts like transformation, aggregation, and joining in KStreams or Kafka Streams.\"}),`\n`,(0,n.jsx)(e.div,{children:(0,n.jsx)(t,{alt:\"kafka-streams-pipeline-example\",src:\"/static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/kafka-streams-pipeline-example.png\",width:\"1348\",height:\"447\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"So first let\\u2019s create the producer that will send messages to the Kafka Topic \",(0,n.jsx)(e.code,{children:\"first-topic\"}),\" every second.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"You can refer to the entire code on my GitHub Repo \",(0,n.jsx)(e.a,{href:\"https://github.com/amrutprabhu/kafka-workouts/tree/master/spring-cloud-stream-kafka-streams-with-kstreams\",children:\"here\"}),\".\"]}),`\n`,(0,n.jsxs)(e.h2,{id:\"creating-a-kafka-publisher-with-spring-cloud-stream-kafka\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#creating-a-kafka-publisher-with-spring-cloud-stream-kafka\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Creating a Kafka Publisher with Spring Cloud Stream Kafka\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Spring Cloud Stream makes use of functional interfaces from \",(0,n.jsx)(e.code,{children:\"java.util.function\"}),\" package to define producers and consumers.\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Hence we will create a simple supplier bean that will supply values as a producer.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-java\",children:(0,n.jsxs)(e.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\" \",(0,n.jsx)(e.span,{className:\"token annotation punctuation\",children:\"@Bean\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Supplier\"}),(0,n.jsxs)(e.span,{className:\"token generics\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsxs)(e.span,{className:\"token class-name\",children:[(0,n.jsxs)(e.span,{className:\"token namespace\",children:[\"org\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"springframework\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"messaging\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"})]}),\"Message\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"MyEvent\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"producer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// random department\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Department\"}),\" department \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Department\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"values\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Random\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"nextInt\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Department\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"values\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"length\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Event playload\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"MyEvent\"}),\" myEvent \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"MyEvent\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Jack\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" department\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"MessageBuilder\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"withPayload\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"myEvent\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"setHeader\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"KafkaHeaders\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"KEY\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" department\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"build\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Here I am creating a producer that will send a message called MyEvent which has a name and department that will be chosen randomly.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Here, the message key is the department and we wrap the payload using the MessageBuilder from Spring.\"}),`\n`,(0,n.jsx)(i,{id:\"adflow1\",slot:\"8168941152\"}),`\n`,(0,n.jsx)(e.p,{children:\"This is how we can create a simple producer that produces a message every second.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Now, let's look at the properties required for this.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-yaml\",children:(0,n.jsxs)(e.code,{className:\"language-yaml code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"spring\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"cloud\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"function\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"definition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` producer\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"stream\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"kafka\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"binder\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brokers\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" localhost\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"9092\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"bindings\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"producer-out-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"producer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"configuration\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"key.serializer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` org.apache.kafka.common.serialization.StringSerializer\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"bindings\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"producer-out-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"destination\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" first\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`topic\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Here we set three things:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"The Binding\"}),\": This registers the binding function\\u2019s parameter.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"The producer configuration\"}),\": To specify the key serializer.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"The Spring Cloud Function definition\"}),\": This is the bean definition of binding.\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"You can read this article \",(0,n.jsx)(e.a,{href:\"https://refactorfirst.com/spring-cloud-stream-with-kafka-communication\",children:\"here\"}),\", wherein I explain in detail how these properties are set, what is the meaning of the \",(0,n.jsx)(e.code,{children:\"-out-\"}),\" property, and how the bindings work.\"]}),`\n`,(0,n.jsx)(e.p,{children:\"I would recommend reading it as it will make it easier to understand the next section in which we will be exploring how we can deal with Kafka Streams or KStreams\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"creating-a-kstream-or-kafka-stream-transformation\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#creating-a-kstream-or-kafka-stream-transformation\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Creating a KStream or Kafka Stream Transformation\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Let\\u2019s consider we want to create a handler that will transfer an input stream and send it out to another Kafka Stream\"}),`\n`,(0,n.jsx)(e.p,{children:\"So our producer above is emitting events and now we will transform them and send them to a new topic.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Now the transformation is as simple as defining the following functional bean.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-java\",children:(0,n.jsxs)(e.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\" \",(0,n.jsx)(e.span,{className:\"token annotation punctuation\",children:\"@Bean\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Function\"}),(0,n.jsxs)(e.span,{className:\"token generics\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"KStream\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"MyEvent\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"KStream\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"enhancer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" input \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\u003e\"}),` input\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"mapValues\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"value \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\u003e\"}),\" value\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"It just takes the input and transforms it by mapping the value which was originally a JSON object to the name inside the JSON Object.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Next, we need to configure the enhancer in the properties file.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-yaml\",children:(0,n.jsxs)(e.code,{className:\"language-yaml code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"spring\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"cloud\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"function\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"definition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` producer;enhancer\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"stream\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"kafka\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"streams\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"bindings\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"enhancer-in-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#   only required if you need to provide some configurations.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"consumer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"keySerde\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` org.apache.kafka.common.serialization.Serdes$StringSerde\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"valueSerde\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" com.amrut.prabhu.dto.coverters.MyEventSerDes \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#custom\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"binder\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brokers\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" localhost\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"9092\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"bindings\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"producer-out-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"producer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"configuration\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"key.serializer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` org.apache.kafka.common.serialization.StringSerializer\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"bindings\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"producer-out-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"destination\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" first\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`topic\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"enhancer-in-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"destination\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" first\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`topic\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"enhancer-out-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"destination\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" second\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`topic\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Here, we do three things.\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"We specify the binding for our enhancer. We specify the topics from which we want to read and write messages to\"}),`\n`,(0,n.jsx)(e.li,{children:\"Our Spring Cloud function definition i.e. enhancer\"}),`\n`,(0,n.jsx)(e.li,{children:\"And finally the key and value serializer and deserializer in the Kafka Streams bindings.\"}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"So here we are creating our custom value serializer which is a simple Json serializer deserializer.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-java\",children:(0,n.jsxs)(e.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"class\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"MyEventSerDes\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"extends\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"JsonSerde\"}),(0,n.jsxs)(e.span,{className:\"token generics\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"MyEvent\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Make sure you look at the properties carefully, as they can be confused with the properties defined under \",(0,n.jsx)(e.code,{children:\"spring.cloud.stream.kafka\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"The serializer and deserializer properties are defined under the \",(0,n.jsx)(e.code,{children:\"spring.cloud.stream.kafka.streams\"}),\" umbrella.\"]}),`\n`,(0,n.jsx)(e.p,{children:\"So be careful about it.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"With this, the input KStream or Kafka Stream coming from the topic \",(0,n.jsx)(e.code,{children:\"first-topic\"}),\"looks like this:\"]}),`\n`,(0,n.jsx)(e.div,{children:(0,n.jsx)(t,{alt:\"first-kafka-stream-output\",src:\"/static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/first-kafka-stream-output.webp\",width:\"1462\",height:\"248\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"While the output sent to the topic \",(0,n.jsx)(e.code,{children:\"second-topic\"}),\" looks like this:\"]}),`\n`,(0,n.jsx)(e.div,{children:(0,n.jsx)(t,{alt:\"second-kafka-stream-output\",src:\"/static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/second-kafka-stream-output.webp\",width:\"1146\",height:\"222\"})}),`\n`,(0,n.jsx)(e.p,{children:\"The images above is using the following format to show the contents of the Kafka topic.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-shell\",children:(0,n.jsx)(e.code,{className:\"language-shell code-highlight\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"Partition: \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\"}),\"Topic partition number\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin class-name\",children:\":\"}),\" Offset: \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\"}),\"Topic offset\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\"}),\"Key\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\"}),\"Value\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"}),`\n`]})})}),`\n`,(0,n.jsx)(e.p,{children:\"We will be using the same format to view the messages in the topics as we go ahead.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Now let\\u2019s look at how we can aggregate data from one stream and send it to another.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"aggregate-data-from-kstream-or-kafka-stream-with-windowing\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#aggregate-data-from-kstream-or-kafka-stream-with-windowing\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Aggregate Data From KStream Or Kafka Stream With Windowing\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Let\\u2019s aggregate data from the \",(0,n.jsx)(e.code,{children:\"first-topic\"}),\" for a time window of 10 seconds and send it over to a \",(0,n.jsx)(e.code,{children:\"third-topic\"}),\" .\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-java\",children:(0,n.jsxs)(e.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\" \",(0,n.jsx)(e.span,{className:\"token annotation punctuation\",children:\"@Bean\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Function\"}),(0,n.jsxs)(e.span,{className:\"token generics\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"KStream\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"MyEvent\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"KStream\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"aggregate\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" input \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\u003e\"}),` input\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"groupByKey\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"windowedBy\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"TimeWindows\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"ofSizeWithNoGrace\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Duration\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"ofSeconds\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"10\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"aggregate\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0l\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                        \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"key\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" value\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" aggregate\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\u003e\"}),\" aggregate \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                        \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Materialized\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"with\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token class-name\",children:[\"Serdes\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"String\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsxs)(e.span,{className:\"token class-name\",children:[\"Serdes\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Long\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"suppress\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Suppressed\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"untilWindowCloses\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token class-name\",children:[\"Suppressed\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"BufferConfig\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"unbounded\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"toStream\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"map\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"w\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" v\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\u003e\"}),\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"KeyValue\"}),(0,n.jsxs)(e.span,{className:\"token generics\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"w\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"key\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" v\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"toString\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Here we first group the data by the key within a window size of 10 seconds.\"}),`\n`,(0,n.jsx)(e.p,{children:\"In the aggregate function, the first parameter is the initial value of 0 for the aggregate. The second parameter is an aggregate function that increments by 1 for every value with the same key in the 10-second window (simulating a count aggregation)\"}),`\n`,(0,n.jsx)(e.p,{children:\"The final parameter is used to specify the serializer and deserializer to materialize the results of the time window in an intermediate topic.\"}),`\n`,(0,n.jsx)(e.p,{children:\"After the aggregate function, we have to specify the suppression, or else the intermediate values during the aggregation window will be sent out to the output topic.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Now, let's look at the properties.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-yaml\",children:(0,n.jsxs)(e.code,{className:\"language-yaml code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"spring\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"cloud\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"function\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"definition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` producer;enhancer;aggregate\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"stream\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"kafka\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"streams\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"bindings\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"enhancer-in-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#   only required if you need to provide some configurations.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"consumer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"keySerde\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` org.apache.kafka.common.serialization.Serdes$StringSerde\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"valueSerde\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" com.amrut.prabhu.dto.coverters.MyEventSerDes \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#custom\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"aggregate-in-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"consumer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"keySerde\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` org.apache.kafka.common.serialization.Serdes$StringSerde\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"valueSerde\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" com.amrut.prabhu.dto.coverters.MyEventSerDes \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#custom\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"binder\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brokers\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" localhost\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"9092\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"bindings\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"producer-out-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"producer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"configuration\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"key.serializer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` org.apache.kafka.common.serialization.StringSerializer\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"bindings\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"producer-out-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"destination\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" first\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`topic\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"enhancer-in-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"destination\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" first\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`topic\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"enhancer-out-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"destination\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" second\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`topic\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"aggregate-in-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"destination\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" first\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`topic\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"aggregate-out-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"destination\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" third\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`topic\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Here we also provide three things.\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"The binding specifies the input and output topic.\"}),`\n`,(0,n.jsxs)(e.li,{children:[\"The binding function definition under the property \",(0,n.jsx)(e.code,{children:\"spring.cloud.function.definiton\"})]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Finally the consumer properties under \",(0,n.jsx)(e.code,{children:\"spring.cloud.stream.kafka.streams\"}),\" specifying the key and value serializer and deserializer.\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"With this, the data will be produced every 10 seconds on the \",(0,n.jsx)(e.code,{children:\"third-topic\"}),\" as shown below.\"]}),`\n`,(0,n.jsx)(e.div,{children:(0,n.jsx)(t,{alt:\"third-kafka-stream-aggregate-output\",src:\"/static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/third-kafka-stream-aggregate-output.webp\",width:\"1380\",height:\"576\"})}),`\n`,(0,n.jsx)(e.p,{children:\"So this is the aggregated count per key in a time window of 10 seconds.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"With this let\\u2019s look at how we can join data from the \",(0,n.jsx)(e.code,{children:\"second-topic\"}),\" and the \",(0,n.jsx)(e.code,{children:\"third-topic\"}),\" and produce the joined value in the \",(0,n.jsx)(e.code,{children:\"fourth-topic\"}),\" .\"]}),`\n`,(0,n.jsxs)(e.h2,{id:\"using-join-on-kstreams-or-kafka-streams-with-windowing\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#using-join-on-kstreams-or-kafka-streams-with-windowing\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Using Join On KStreams or Kafka Streams with Windowing\"]}),`\n`,(0,n.jsx)(e.p,{children:\"To create a Join of two Kafka Streams we will make use of a Bifunction.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-java\",children:(0,n.jsxs)(e.code,{className:\"language-Java code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\" \",(0,n.jsx)(e.span,{className:\"token annotation punctuation\",children:\"@Bean\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"BiFunction\"}),(0,n.jsxs)(e.span,{className:\"token generics\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"KStream\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"KStream\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"KStream\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"JoinedValue\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"join\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"input1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" input2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\u003e\"}),\" input1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"join\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"input2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"value1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" value2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"JoinedValue\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"value1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" value2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"JoinWindows\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"ofTimeDifferenceWithNoGrace\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Duration\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"of\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"10\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ChronoUnit\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"SECONDS\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"StreamJoined\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"with\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token class-name\",children:[\"Serdes\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"String\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsxs)(e.span,{className:\"token class-name\",children:[\"Serdes\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"String\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),(0,n.jsxs)(e.span,{className:\"token class-name\",children:[\"Serdes\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"String\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"In the function above, we take the messages from the \",(0,n.jsx)(e.code,{children:\"second-topic\"}),\" and join them directly with the messages from the \",(0,n.jsx)(e.code,{children:\"third-topic\"}),\" for a time window of 10 seconds resulting in a cartesian product.\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Every message will be combined with a message from the other topic based on the key. This will result in an output just like a full join in SQL.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Let\\u2019s look at the properties.\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-yaml\",children:(0,n.jsxs)(e.code,{className:\"language-yaml code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"spring\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"cloud\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"function\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"definition\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` producer;enhancer;aggregate;join\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"stream\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"kafka\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"streams\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"bindings\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"enhancer-in-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#   only required if you need to provide some configurations.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"consumer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"keySerde\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` org.apache.kafka.common.serialization.Serdes$StringSerde\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"valueSerde\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" com.amrut.prabhu.dto.coverters.MyEventSerDes \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#custom\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"aggregate-in-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"consumer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"keySerde\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` org.apache.kafka.common.serialization.Serdes$StringSerde\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"valueSerde\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" com.amrut.prabhu.dto.coverters.MyEventSerDes \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#custom\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"join-out-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"producer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"keySerde\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` org.apache.kafka.common.serialization.Serdes$StringSerde\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"valueSerde\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` com.amrut.prabhu.dto.coverters.JoinedValueSerDes\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"binder\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"brokers\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" localhost\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"9092\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"bindings\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"producer-out-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"producer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"configuration\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"key.serializer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` org.apache.kafka.common.serialization.StringSerializer\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"bindings\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"producer-out-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"destination\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" first\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`topic\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"enhancer-in-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"destination\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" first\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`topic\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"enhancer-out-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"destination\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" second\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`topic\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"aggregate-in-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"destination\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" first\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`topic\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"aggregate-out-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"destination\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" third\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`topic\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"#\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"join-in-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"destination\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" second\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`topic\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"join-in-1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"destination\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" third\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`topic\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"join-out-0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token key atrule\",children:\"destination\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" fourth\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`topic\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Here, if you look carefully, in the binding we specify two inputs and one output.\"}),`\n`,(0,n.jsx)(e.p,{children:\"The rest is the same as adding the function definition and the serializer and deserializer properties as we did for the other bindings above.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"When we run this, it produces the following messages on the \",(0,n.jsx)(e.code,{children:\"fourth-topic\"})]}),`\n`,(0,n.jsx)(e.div,{children:(0,n.jsx)(t,{alt:\"fourth-kafka-stream-join-output\",src:\"/static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/fourth-kafka-stream-join-output.webp\",width:\"1324\",height:\"700\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"You can refer to the entire code on my GitHub Repo \",(0,n.jsx)(e.a,{href:\"https://github.com/amrutprabhu/kafka-workouts/tree/master/spring-cloud-stream-kafka-streams-with-kstreams\",children:\"here\"}),\".\"]}),`\n`,(0,n.jsx)(e.p,{children:\"If you are interested in learning more about Java and Spring Boot, here are some interesting articles to look at.\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://refactorfirst.com/spring-boot-3-with-docker-compose-support\",children:(0,n.jsx)(e.strong,{children:\"Spring Boot 3.1 Docker Compose Support\"})})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://refactorfirst.com/defining-event-driven-achitectures-asyncapi\",children:(0,n.jsx)(e.strong,{children:\"Defining Event-Driven Architectures\\u200A\\u2014\\u200AAsyncAPI\"})})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://refactorfirst.com/how-does-fido2-passwordless-authentication-work\",children:(0,n.jsx)(e.strong,{children:\"FIDO2 Passwordless Authentication With KeyCloak\"})})}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"I keep exploring and learning new things. If you want to know the latest trends and improve your software development skills, then subscribe to my newsletter below and also follow me on \",(0,n.jsx)(e.a,{href:\"https://twitter.com/amrutprabhu42\",children:\"Twitter\"}),\".\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Enjoy!!\"})]})}}var v=b;function p(a,s){throw new Error(\"Expected \"+(s?\"component\":\"object\")+\" `\"+a+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return j;})();\n;return Component;","toc":[{"value":"KStreams, Kafka Streams — Aggregate, Transform, and Join using Spring Cloud Stream","url":"#kstreams-kafka-streamsaggregate-transform-and-join-using-spring-cloud-stream","depth":3},{"value":"Creating a project with Spring Cloud Streams","url":"#creating-a-project-with-spring-cloud-streams","depth":2},{"value":"Creating a Kafka Publisher with Spring Cloud Stream Kafka","url":"#creating-a-kafka-publisher-with-spring-cloud-stream-kafka","depth":2},{"value":"Creating a KStream or Kafka Stream Transformation","url":"#creating-a-kstream-or-kafka-stream-transformation","depth":2},{"value":"Aggregate Data From KStream Or Kafka Stream With Windowing","url":"#aggregate-data-from-kstream-or-kafka-stream-with-windowing","depth":2},{"value":"Using Join On KStreams or Kafka Streams with Windowing","url":"#using-join-on-kstreams-or-kafka-streams-with-windowing","depth":2}],"frontMatter":{"readingTime":{"text":"13 min read","minutes":12.09,"time":725400,"words":2418},"slug":"2023/spring-cloud-kafka-streams-aggregate-join-windowing","fileName":"2023/spring-cloud-kafka-streams-aggregate-join-windowing.md","title":"KStreams, Kafka Streams — Aggregate, Transform, and Join With Windowing using Spring Cloud Stream","author":"Amrut Prabhu","categories":"","tags":["Java","Spring Boot","Kakfa","Spring cloud Stream","Kstream","kafka stream"],"photo-credits":null,"applaud-link":"2021/spring-boot-stream-kafka.json","date":"2023-08-24T00:00:00.000Z","draft":false,"summary":"In this article, we will explore Kstreams or Kafka Streams with aggregate, join, and windowing concepts using Spring Cloud Stream Kafka Streams","imageUrl":"/static/images/2023/spring-cloud-kafka-stream-aggregate-join-window/cover.jpg","actualUrl":"2023/spring-cloud-kafka-streams-aggregate-join-windowing","customUrl":"spring-cloud-kafka-streams-aggregate-join-windowing"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.875,"time":52500,"words":175},"slug":["default"],"fileName":"default.md","name":"Amrut Prabhu","avatar":"/static/images/avatar-small.jpg","avatarBig":"/static/images/avatar-big.jpg","occupation":"Staff Engineer","company":"Personal","email":"contact@refactorfirst.com","twitter":"https://twitter.com/amrutprabhu42","linkedin":"https://www.linkedin.com/in/amrut-prabhu-722baa65/","github":"https://github.com/amrutprabhu","customUrl":"default","actualUrl":"default","date":null}],"prev":{"title":"How to Search \u0026 Query Redis with A Spring Boot Application","author":"Amrut Prabhu","categories":"","tags":["Java","Spring Boot","Redis Search","Redis JSON","Redis Hash","Redis Insight"],"photo-credits":null,"applaud-link":"2021/spring-boot-stream-kafka.json","date":"2023-07-13T00:00:00.000Z","draft":false,"summary":"In this article, we will look into how you can search and query Redis using a Spring Boot Application and also visualize this using Redis Insights","imageUrl":"/static/images/2023/spring-boot-with-redis/cover.jpg","actualUrl":"2023/spring-boot-with-redis-stack-and-redis-insight","customUrl":"spring-boot-with-redis-stack-and-redis-insight","slug":"spring-boot-with-redis-stack-and-redis-insight"},"next":null},"__N_SSG":true},"page":"/[slug]","query":{"slug":"spring-cloud-kafka-streams-aggregate-join-windowing"},"buildId":"DubunCy8_pPNL3TpgvJ0m","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>