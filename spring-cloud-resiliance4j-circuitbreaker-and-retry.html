<!DOCTYPE html><html lang="en"><head><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/icon.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/icon.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" content="#000000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');d.add('light');if("system"===e||(!e&&false)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="amrutprabhu" data-description="Support me on Buy me a coffee!" data-message="" data-color="#FFDD00" data-position="Right" data-x_margin="18" data-y_margin="18" strategy="afterInteractive" async=""></script><title>Circuit Breaker And Retry with Spring Cloud Resiliance4j | RefactorFirst</title><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7490174059724719" crossorigin="anonymous"></script><meta name="robots" content="follow, index"/><meta name="description" content="In this article, we will be looking into how we can integrate a circuit breaker and a retry mechanism, to handle failures while making synchronous calls to another service."/><meta property="og:url" content="https://refactorfirst.com/spring-cloud-resiliance4j-circuitbreaker-and-retry"/><meta property="og:type" content="article"/><meta property="og:site_name" content="RefactorFirst"/><meta property="og:description" content="In this article, we will be looking into how we can integrate a circuit breaker and a retry mechanism, to handle failures while making synchronous calls to another service."/><meta property="og:title" content="Circuit Breaker And Retry with Spring Cloud Resiliance4j"/><meta property="og:image" content="https://refactorfirst.com/static/images/2021/spring-resiliance4j-circuitbreaker-retry/cover.jpg"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="https://twitter.com/amrutprabhu42"/><meta name="twitter:title" content="Circuit Breaker And Retry with Spring Cloud Resiliance4j"/><meta name="twitter:description" content="In this article, we will be looking into how we can integrate a circuit breaker and a retry mechanism, to handle failures while making synchronous calls to another service."/><meta name="twitter:image" content="https://refactorfirst.com/static/images/2021/spring-resiliance4j-circuitbreaker-retry/cover.jpg"/><meta property="article:published_time" content="2021-12-02T00:00:00.000Z"/><link rel="canonical" href="https://refactorfirst.com/spring-cloud-resiliance4j-circuitbreaker-and-retry"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://refactorfirst.com/2021/spring-cloud-resiliance4j-circuitbreaker-and-retry"
  },
  "headline": "Circuit Breaker And Retry with Spring Cloud Resiliance4j",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://refactorfirst.com/static/images/2021/spring-resiliance4j-circuitbreaker-retry/cover.jpg"
    }
  ],
  "datePublished": "2021-12-02T00:00:00.000Z",
  "dateModified": "2021-12-02T00:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Amrut Prabhu"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Amrut Prabhu",
    "logo": {
      "@type": "ImageObject",
      "url": "https://refactorfirst.com/static/images/favicons/icon.png"
    }
  },
  "description": "In this article, we will be looking into how we can integrate a circuit breaker and a retry mechanism, to handle failures while making synchronous calls to another service."
}</script><meta name="next-head-count" content="22"/><link rel="preload" href="/_next/static/css/7b44aadccc233deb.css" as="style"/><link rel="stylesheet" href="/_next/static/css/7b44aadccc233deb.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-0dfbf29ef9c09171.js" defer=""></script><script src="/_next/static/chunks/main-a8532ea7c2505ecc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-115c3eb9acb4de97.js" defer=""></script><script src="/_next/static/chunks/framework-327e104994690a53.js" defer=""></script><script src="/_next/static/chunks/207-4f91422181f853c0.js" defer=""></script><script src="/_next/static/chunks/102-d4801a7f87c6df7d.js" defer=""></script><script src="/_next/static/chunks/883-e325a2ee4fed4a84.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bslug%5D-da416b81bf0ecd48.js" defer=""></script><script src="/_next/static/_mDO0DwDYqH9QlMpUH7QG/_buildManifest.js" defer=""></script><script src="/_next/static/_mDO0DwDYqH9QlMpUH7QG/_ssgManifest.js" defer=""></script><script src="/_next/static/_mDO0DwDYqH9QlMpUH7QG/_middlewareManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap">@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v12/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v12/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuGKYMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v12/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuFuYMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v12/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v12/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v12/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v12/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v12/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v12/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v12/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v12/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v12/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v12/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v12/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v12/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v12/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v12/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v12/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v12/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v12/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v12/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v12/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v12/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v12/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body class="antialiased text-black bg-white dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-6xl xl:px-0"><div class="flex flex-col justify-between h-screen"><header class="flex items-center justify-between py-10"><div><a aria-label="RefactorFirst" href="/"><div class="flex items-center justify-between"><div class="mr-3"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmVyc2lvbj0iMS4xIi8+"/></span><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img srcSet="/static/favicons/icon.png?imwidth=64 1x, /static/favicons/icon.png?imwidth=128 2x" src="/static/favicons/icon.png?imwidth=128" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div><div class="h-6 text-2xl font-semibold sm:block">RefactorFirst</div></div></a></div><div class="mt-6"></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/tags">Tags</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/posts">Posts</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/about">About</a></div><button aria-label="Toggle Dark Mode" type="button" class="w-8 h-8 p-1 ml-1 mr-1 rounded sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="w-8 h-8 py-1 ml-1 mr-1 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed w-full h-full top-24 right-0 bg-gray-200 dark:bg-gray-800 opacity-95 z-10 transform ease-in-out duration-300 translate-x-full"><button type="button" aria-label="toggle modal" class="fixed w-full h-full cursor-auto focus:outline-none"></button><nav class="fixed h-full mt-8"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/posts">Posts</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/about">About</a></div></nav></div></div></div></header><main class="mb-auto"><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-6xl xl:px-0"><div class="fixed flex-col hidden gap-3 right-8 bottom-8 md:flex"><button aria-label="Scroll To Top" type="button" style="opacity:0" class="p-2 text-gray-500 transition-all bg-gray-200 rounded-full dark:text-gray-400 dark:bg-gray-700 dark:hover:bg-gray-600 hover:bg-gray-300"><svg class="w-5 h-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2021-12-02T00:00:00.000Z">Thursday, December 2, 2021</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">Circuit Breaker And Retry with Spring Cloud Resiliance4j</h1><div class="mt-6"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNzQ0IiBoZWlnaHQ9IjQwNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2ZXJzaW9uPSIxLjEiLz4="/></span><img alt="Circuit Breaker And Retry with Spring Cloud Resiliance4j" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="object-cover object-center lg:h-48 md:h-36" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="Circuit Breaker And Retry with Spring Cloud Resiliance4j" srcSet="static/images/2021/spring-resiliance4j-circuitbreaker-retry/cover.jpg?imwidth=750 1x, static/images/2021/spring-resiliance4j-circuitbreaker-retry/cover.jpg?imwidth=1920 2x" src="static/images/2021/spring-resiliance4j-circuitbreaker-retry/cover.jpg?imwidth=1920" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="object-cover object-center lg:h-48 md:h-36" loading="lazy"/></noscript></span></div><div class="text-primary-500 hover:text-primary-600 text-md dark:hover:text-primary-400"><a target="_blank" rel="noopener noreferrer" href="https://unsplash.com/photos/kK7uPfb2YWU"> Photo Credits</a></div><div class="mt-2 text-gray-500 dark:text-gray-400">11 min read</div></div></div></header><div class="pb-8 divide-y divide-gray-200 xl:divide-y-0 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:pt-11 xl:border-b xl:border-gray-200 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 xl:block sm:space-x-12 xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzgiIGhlaWdodD0iMzgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmVyc2lvbj0iMS4xIi8+"/></span><img alt="avatar" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="w-10 h-10 rounded-full" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="avatar" srcSet="static/images/avatar-small.jpg?imwidth=48 1x, static/images/avatar-small.jpg?imwidth=96 2x" src="static/images/avatar-small.jpg?imwidth=96" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="w-10 h-10 rounded-full" loading="lazy"/></noscript></span><dl class="text-sm font-medium leading-5 whitespace-nowrap"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">Amrut Prabhu</dd><dt class="sr-only">Twitter</dt><dd><a target="_blank" rel="noopener noreferrer" href="https://twitter.com/amrutprabhu42" class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400">@amrutprabhu42</a></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:pb-0 xl:col-span-3 xl:row-span-2"><div class="pt-10 pb-8 prose text-md dark:prose-dark max-w-none"><div></div><div><p>In this article, we will be looking into how we can integrate a circuit breaker and a retry mechanism, to handle failures while making synchronous calls to another service.</p>
<h2 id="introduction"><a href="#introduction" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Introduction</h2>
<p>With the growing number of services, services might need to communicate with other servers synchronously and hence become dependent on the upstream service. Any problems while communicating with the upstream services, will propagate to the downstream services.</p>
<p>To protect the services from such problems, we can use some of the patterns to protect the service. So, today we are going to look into two of these, i.e the Circuit Breaker and the Retry mechanism.</p>
<p>Let&#x27;s first look at the Retry mechanism.</p>
<h2 id="integrating-retry"><a href="#integrating-retry" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Integrating Retry</h2>
<p>Let’s go to <a target="_blank" rel="noopener noreferrer" href="https://start.spring.io">https://start.spring.io</a> and create a simple spring boot application with the following dependencies.</p>
<div class="relative"><pre><code class="language-xml code-highlight"><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-circuitbreaker-resilience4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-aspects<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</span></code></pre></div>
<p>Along with the circuit-breaker starter dependency, we need the spring aspects dependencies, as the retry and circuit breaker mechanism works using the Spring AOP concept.</p>
<p>Next, we are going to add a service class that will make a REST call to an endpoint using a RestTemplate.</p>
<div class="relative"><pre><code class="language-java code-highlight"><span class="code-line"><span class="token annotation punctuation">@org.springframework.stereotype.Service</span>
</span><span class="code-line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Service</span> <span class="token punctuation">{</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${service2.url:http://localhost:6060/service2}&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token class-name">String</span> serviceUrl<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token annotation punctuation">@Retry</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;myRetry&quot;</span><span class="token punctuation">,</span> fallbackMethod <span class="token operator">=</span> <span class="token string">&quot;fallback&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot; Making a request to &quot;</span> <span class="token operator">+</span> serviceUrl <span class="token operator">+</span> <span class="token string">&quot; at :&quot;</span> <span class="token operator">+</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="token class-name">RestTemplate</span> restTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">return</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span>serviceUrl<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">fallback</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token string">&quot;fallback value&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div>
<p>As you can see, we have the retry annotation on this method and the name of the fallback method if the retry count runs out. We will call the <code>fetchData</code> method from a controller which just has a simple get mapping.</p>
<div class="relative"><pre><code class="language-java code-highlight"><span class="code-line"><span class="token annotation punctuation">@RestController</span>
</span><span class="code-line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Controller</span> <span class="token punctuation">{</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token annotation punctuation">@Autowired</span>
</span><span class="code-line">    <span class="token keyword">private</span> <span class="token class-name">Service</span> service<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">return</span> service<span class="token punctuation">.</span><span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div>
<p>Now, let&#x27;s look at the retry configuration.</p>
<div class="relative"><pre><code class="language-yaml code-highlight"><span class="code-line"><span class="token key atrule">resilience4j</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">retry</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token key atrule">instances</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">myRetry</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">max-attempts</span><span class="token punctuation">:</span> <span class="token number">3</span>
</span><span class="code-line">        <span class="token key atrule">wait-duration</span><span class="token punctuation">:</span> 5s
</span></code></pre></div>
<p>In this, we are creating the most straightforward configuration of retrying only 3 times and the interval between retries is 5 secs.</p>
<p>With this let’s start the application and make a call to the get endpoint.</p>
<div><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODM5IiBoZWlnaHQ9IjcwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIvPg=="/></span><img alt="curl request fall back" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="curl request fall back" srcSet="static/images/2021/spring-resiliance4j-circuitbreaker-retry/curl-request-fallback.png?imwidth=1080 1x, static/images/2021/spring-resiliance4j-circuitbreaker-retry/curl-request-fallback.png?imwidth=1920 2x" src="static/images/2021/spring-resiliance4j-circuitbreaker-retry/curl-request-fallback.png?imwidth=1920" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div>
<div><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA0MCIgaGVpZ2h0PSIxMDQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmVyc2lvbj0iMS4xIi8+"/></span><img alt="retry fixed rate" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="retry fixed rate" srcSet="static/images/2021/spring-resiliance4j-circuitbreaker-retry/first-retry-5-secs-diff.png?imwidth=1080 1x, static/images/2021/spring-resiliance4j-circuitbreaker-retry/first-retry-5-secs-diff.png?imwidth=3840 2x" src="static/images/2021/spring-resiliance4j-circuitbreaker-retry/first-retry-5-secs-diff.png?imwidth=3840" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div>
<p>This was retrying after a fixed rate of 5 secs.</p>
<h3 id="exponential-retries"><a href="#exponential-retries" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Exponential Retries</h3>
<p>Now, It may happen that retrying after a fixed time could cause the upstream service to further not respond ( probably it’s already overwhelmed with many requests). In this case, we can provide an exponential back-off mechanism.</p>
<p>Let&#x27;s add this config.</p>
<div class="relative"><pre><code class="language-yaml code-highlight"><span class="code-line"><span class="token key atrule">resilience4j</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">retry</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token key atrule">instances</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">myRetry</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">max-attempts</span><span class="token punctuation">:</span> <span class="token number">3</span>
</span><span class="code-line">        <span class="token key atrule">wait-duration</span><span class="token punctuation">:</span> 5s
</span><span class="code-line">        <span class="token key atrule">enable-exponential-backoff</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">        <span class="token key atrule">exponential-backoff-multiplier</span><span class="token punctuation">:</span> <span class="token number">2</span>
</span></code></pre></div>
<p>The exponent backoff works in the following way:</p>
<div class="relative"><pre><code class="language-shell code-highlight"><span class="code-line">wait-duration * <span class="token punctuation">(</span>exponential-backoff-multiplier ^ <span class="token punctuation">(</span>retry iteration count<span class="token punctuation">))</span>
</span></code></pre></div>
<p>So with the above configuration, The reties will occur at the following times.</p>
<div class="relative"><pre><code class="language-groovy code-highlight"><span class="code-line">1st Retry  <span class="token operator">-</span> 5s <span class="token operator">*</span> <span class="token number">2</span><span class="token operator">^</span><span class="token number">0</span> <span class="token operator">=</span> after <span class="token number">5</span> seconds
</span><span class="code-line">2nd Retry  <span class="token operator">-</span> 5s <span class="token operator">*</span> <span class="token number">2</span><span class="token operator">^</span><span class="token number">1</span> <span class="token operator">=</span> after <span class="token number">10</span> seconds
</span><span class="code-line">3rd Retry  <span class="token operator">-</span> 5s <span class="token operator">*</span> <span class="token number">2</span><span class="token operator">^</span><span class="token number">2</span> <span class="token operator">=</span> after <span class="token number">20</span> seconds
</span><span class="code-line"><span class="token operator">..</span>
</span><span class="code-line"><span class="token operator">..</span>
</span><span class="code-line">nTh Retry <span class="token operator">-</span> 5s <span class="token operator">*</span> <span class="token number">2</span><span class="token operator">^</span>n
</span></code></pre></div>
<div><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTExOCIgaGVpZ2h0PSIxMTIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmVyc2lvbj0iMS4xIi8+"/></span><img alt="exponential retry" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="exponential retry" srcSet="static/images/2021/spring-resiliance4j-circuitbreaker-retry/retry-with-exponential.png?imwidth=1200 1x, static/images/2021/spring-resiliance4j-circuitbreaker-retry/retry-with-exponential.png?imwidth=3840 2x" src="static/images/2021/spring-resiliance4j-circuitbreaker-retry/retry-with-exponential.png?imwidth=3840" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div>
<h3 id="conditional-retry-on-exceptions"><a href="#conditional-retry-on-exceptions" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Conditional Retry on Exceptions</h3>
<p>Let&#x27;s consider there may be certain exceptions you want to retry and some exceptions you don&#x27;t want to retry.</p>
<p>For example, when we send a bad request, no matter the number of retries, we will always get the same error. In this case, we would not want to retry. But for say 404 errors, we would want to retry ( probably the service is temporarily unavailable).</p>
<p>In such cases, we can configure for which exception type we should retry or not. To do this we need to add the following config properties.</p>
<div class="relative"><pre><code class="language-yaml code-highlight"><span class="code-line"><span class="token key atrule">resilience4j</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">retry</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">instances</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token key atrule">myRetry</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">max-attempts</span><span class="token punctuation">:</span> <span class="token number">5</span>
</span><span class="code-line">      <span class="token key atrule">wait-duration</span><span class="token punctuation">:</span> 5s
</span><span class="code-line">      <span class="token key atrule">enable-exponential-backoff</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">      <span class="token key atrule">exponential-backoff-multiplier</span><span class="token punctuation">:</span> <span class="token number">2</span>
</span><span class="code-line">      <span class="token key atrule">retry-exceptions</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token punctuation">-</span> org.springframework.web.client.RestClientException
</span><span class="code-line">      <span class="token key atrule">ignore-exceptions</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token punctuation">-</span> com.amrut.prabhu.IgnoreException
</span></code></pre></div>
<p>Just as an example I have declared that I do not want to retry when an exception of type <code>IgnoreException</code> is thrown.</p>
<p>Now, these were some of the configuration properties for the Resilience4J Retry mechanism.</p>
<p>Let’s look at yet another concept called the Circuit Breaker.</p>
<h2 id="integrating-a-circuit-breaker"><a href="#integrating-a-circuit-breaker" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Integrating a Circuit Breaker</h2>
<p>A circuit breaker is a mechanism that allows the application to protect itself from unreliable downstream services. This prevents cascading failures to be propagated throughout the system and helps to build fault-tolerant and reliable services.</p>
<p>The support for the circuit breaker is already present in the dependency we added so let’s make use of it.</p>
<div class="relative"><pre><code class="language-java code-highlight"><span class="code-line"><span class="token annotation punctuation">@CircuitBreaker</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;myCircuitBreaker&quot;</span><span class="token punctuation">,</span> fallbackMethod <span class="token operator">=</span> <span class="token string">&quot;fallback&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token annotation punctuation">@Retry</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;myRetry&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot; Making a request to &quot;</span> <span class="token operator">+</span> serviceUrl <span class="token operator">+</span> <span class="token string">&quot; at :&quot;</span> <span class="token operator">+</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token class-name">RestTemplate</span> restTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">return</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span>serviceUrl<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div>
<p><strong>Note:</strong> Carefully notice I have removed the fallback method from the retry annotation. Because I want the circuit breaker to take over when the retries have exhausted.</p>
<p>Let’s configure the circuit breaker.</p>
<div class="relative"><pre><code class="language-yaml code-highlight"><span class="code-line"><span class="token key atrule">resilience4j</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">retry</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">instances</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">myRetry</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">max-attempts</span><span class="token punctuation">:</span> <span class="token number">3</span>
</span><span class="code-line">        <span class="token key atrule">wait-duration</span><span class="token punctuation">:</span> 5s
</span><span class="code-line">        <span class="token key atrule">enable-exponential-backoff</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">        <span class="token key atrule">exponential-backoff-multiplier</span><span class="token punctuation">:</span> <span class="token number">2</span>
</span><span class="code-line">        <span class="token key atrule">retry-exceptions</span><span class="token punctuation">:</span>
</span><span class="code-line">         <span class="token punctuation">-</span> org.springframework.web.client.RestClientException
</span><span class="code-line">        <span class="token key atrule">ignore-exceptions</span><span class="token punctuation">:</span>
</span><span class="code-line">         <span class="token punctuation">-</span> com.amrut.prabhu.IgnoreException
</span><span class="code-line">  <span class="token key atrule">circuitbreaker</span><span class="token punctuation">:</span>  <span class="token key atrule">instances</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">myCircuitBreaker</span><span class="token punctuation">:</span>
</span><span class="code-line">       <span class="token key atrule">wait-duration-in-open-state</span><span class="token punctuation">:</span> 1m
</span><span class="code-line">       <span class="token key atrule">permitted-number-of-calls-in-half-open-state</span><span class="token punctuation">:</span> <span class="token number">3</span>
</span><span class="code-line">       <span class="token key atrule">sliding-window-type</span><span class="token punctuation">:</span> count<span class="token punctuation">-</span>based
</span><span class="code-line">       <span class="token key atrule">sliding-window-size</span><span class="token punctuation">:</span> <span class="token number">5</span>
</span><span class="code-line">       <span class="token key atrule">minimum-number-of-calls</span><span class="token punctuation">:</span> <span class="token number">5</span>
</span><span class="code-line">       <span class="token key atrule">slow-call-duration-threshold</span><span class="token punctuation">:</span> 10s
</span><span class="code-line">       <span class="token key atrule">slow-call-rate-threshold</span><span class="token punctuation">:</span> <span class="token number">60</span>
</span><span class="code-line">       <span class="token key atrule">failure-rate-threshold</span><span class="token punctuation">:</span> <span class="token number">60</span>
</span></code></pre></div>
<h3 id="understanding-the-circuit-breaker-config"><a href="#understanding-the-circuit-breaker-config" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Understanding the Circuit Breaker Config</h3>
<p>Here, I am using a count-based sliding window, wherein the window size is of 5 events, and the failure and slowness threshold rate is 60%.</p>
<blockquote>
<p>Now, what does this sliding window mean?</p>
</blockquote>
<p>It means that we would consider a set of 5 consecutive events ( success or failures), to determine if the circuit breaker should transition to an OPEN or CLOSED state.</p>
<p>The term OPEN state means the circuit breaker is activated thereby not allowing calls to be made to the upstream service.</p>
<p>Now, in the above config, if in 5 calls, 60% of the calls fail or are slow ( i.e at least 3 calls), then the circuit breaker would move to the OPEN state. Once the circuit breaker moves to the OPEN state, it would wait in this state for 1 minute before moving to a HALF-OPEN state.</p>
<blockquote>
<p>Now, what is this HALF-OPEN state?</p>
</blockquote>
<p>This state is like an evaluation state, where we check based on a limited number of permitted calls if the circuit breaker moves to either OPEN or CLOSED state. Based on the permitted number of calls, if the number of slow or failures exceeds the slowness or failure threshold then the circuit breaker moves back to the OPEN state or else moves it to the CLOSED state.</p>
<p>For example, In the above config, since we have set the number of permitted calls in HALF_OPEN state as 3, at least 2 calls need to succeed in order for the circuit breaker to move back to the CLOSED state and allow the calls to the upstream server.</p>
<div><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTQyIiBoZWlnaHQ9IjQxOCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2ZXJzaW9uPSIxLjEiLz4="/></span><img alt="" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="" srcSet="static/images/2021/spring-resiliance4j-circuitbreaker-retry/circuit-breaker-state-transition.png?imwidth=640 1x, static/images/2021/spring-resiliance4j-circuitbreaker-retry/circuit-breaker-state-transition.png?imwidth=1200 2x" src="static/images/2021/spring-resiliance4j-circuitbreaker-retry/circuit-breaker-state-transition.png?imwidth=1200" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div>
<h2 id="circuit-breaker-and-retry-config-together"><a href="#circuit-breaker-and-retry-config-together" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Circuit Breaker and Retry Config Together</h2>
<p>Now with the above config, let’s start the application and make a request to the endpoint.</p>
<div><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODM5IiBoZWlnaHQ9IjcwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIvPg=="/></span><img alt="fallback curl request" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="fallback curl request" srcSet="static/images/2021/spring-resiliance4j-circuitbreaker-retry/curl-request-fallback.png?imwidth=1080 1x, static/images/2021/spring-resiliance4j-circuitbreaker-retry/curl-request-fallback.png?imwidth=1920 2x" src="static/images/2021/spring-resiliance4j-circuitbreaker-retry/curl-request-fallback.png?imwidth=1920" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div>
<div><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTE5MyIgaGVpZ2h0PSI1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2ZXJzaW9uPSIxLjEiLz4="/></span><img alt="no retry with circuit breaker" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="no retry with circuit breaker" srcSet="static/images/2021/spring-resiliance4j-circuitbreaker-retry/no-retry-with-circuit-breaker.png?imwidth=1200 1x, static/images/2021/spring-resiliance4j-circuitbreaker-retry/no-retry-with-circuit-breaker.png?imwidth=3840 2x" src="static/images/2021/spring-resiliance4j-circuitbreaker-retry/no-retry-with-circuit-breaker.png?imwidth=3840" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div>
<p>On making a request we see that it only tried once and directly returned us the fallback value. This is because the circuit breaker fallback method was called directly and the retry was not triggered. The reason for this is the order in which the spring aspects handling the two mechanisms are arranged.</p>
<h3 id="circuit-breaker-and-retry-aspects-order"><a href="#circuit-breaker-and-retry-aspects-order" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Circuit Breaker and Retry Aspects Order</h3>
<p>As the implementation of the circuit breaker and retry mechanism work by making use of spring’s method-based AOP mechanism, the aspects handling the two different mechanisms have a certain order.</p>
<p>By default, the retry mechanism has lower priority and hence it warps around the circuit breaker aspect.</p>
<div class="relative"><pre><code class="code-highlight"><span class="code-line"> Retry  ( Circuit Breaker ( function ) )
</span></code></pre></div>
<p>Now to change this, we can add an “aspect order” property to define the order as shown below.</p>
<div class="relative"><pre><code class="language-yaml code-highlight"><span class="code-line"><span class="token key atrule">resilience4j</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token key atrule">retry</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token key atrule">retry-aspect-order</span><span class="token punctuation">:</span> <span class="token number">2</span>
</span><span class="code-line">    <span class="token key atrule">instances</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">myRetry</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">max-attempts</span><span class="token punctuation">:</span> <span class="token number">3</span>
</span><span class="code-line">        <span class="token key atrule">wait-duration</span><span class="token punctuation">:</span> 5s
</span><span class="code-line">        <span class="token key atrule">enable-exponential-backoff</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">        <span class="token key atrule">exponential-backoff-multiplier</span><span class="token punctuation">:</span> <span class="token number">2</span>
</span><span class="code-line">        <span class="token key atrule">retry-exceptions</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> org.springframework.web.client.RestClientException
</span><span class="code-line">        <span class="token key atrule">ignore-exceptions</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> com.amrut.prabhu.IgnoreException
</span><span class="code-line">  <span class="token key atrule">circuitbreaker</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token key atrule">circuit-breaker-aspect-order</span><span class="token punctuation">:</span> <span class="token number">1</span>
</span><span class="code-line">    <span class="token key atrule">instances</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token key atrule">myCircuitBreaker</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token key atrule">wait-duration-in-open-state</span><span class="token punctuation">:</span> 1m
</span><span class="code-line">        <span class="token key atrule">permitted-number-of-calls-in-half-open-state</span><span class="token punctuation">:</span> <span class="token number">3</span>
</span><span class="code-line">        <span class="token key atrule">sliding-window-type</span><span class="token punctuation">:</span> count<span class="token punctuation">-</span>based
</span><span class="code-line">        <span class="token key atrule">sliding-window-size</span><span class="token punctuation">:</span> <span class="token number">5</span>
</span><span class="code-line">        <span class="token key atrule">minimum-number-of-calls</span><span class="token punctuation">:</span> <span class="token number">5</span>
</span><span class="code-line">        <span class="token key atrule">slow-call-duration-threshold</span><span class="token punctuation">:</span> 10s
</span><span class="code-line">        <span class="token key atrule">slow-call-rate-threshold</span><span class="token punctuation">:</span> <span class="token number">60</span>
</span><span class="code-line">        <span class="token key atrule">failure-rate-threshold</span><span class="token punctuation">:</span> <span class="token number">60</span>
</span></code></pre></div>
<p>The higher the order value, the higher is the priority. You can read about the default priority order in the documentation <a target="_blank" rel="noopener noreferrer" href="https://resilience4j.readme.io/docs/getting-started-3#aspect-order">here</a>.</p>
<p>With this when we run the application, we get the following output.</p>
<div><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOTI0IiBoZWlnaHQ9Ijg5IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIvPg=="/></span><img alt="retry with circuit breaker" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="retry with circuit breaker" srcSet="static/images/2021/spring-resiliance4j-circuitbreaker-retry/retry-with-circuit-breaker.png?imwidth=1080 1x, static/images/2021/spring-resiliance4j-circuitbreaker-retry/retry-with-circuit-breaker.png?imwidth=1920 2x" src="static/images/2021/spring-resiliance4j-circuitbreaker-retry/retry-with-circuit-breaker.png?imwidth=1920" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div>
<p>With this, the 3 retries happen and then the circuit breaker aspect would take over.</p>
<p>If you carefully want to understand the working of the circuit breaker and retry mechanism, I have written an integration test which you can refer to <a target="_blank" rel="noopener noreferrer" href="https://github.com/amrutprabhu/spring-resilience4j-circuit-breaker-and-retry/blob/main/spring-boot-with-circuit-breaker-and-retry/src/test/java/com/amrut/prabhu/CircuitBreakerAndRetryTest.java">here</a></p>
<h3 id="conclusion"><a href="#conclusion" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Conclusion</h3>
<p>With this, we just saw how we can integrate a Circuit Breaker and a Retry mechanism in a spring boot application. Similarly, we can integrate rate limiter, bulkhead, etc. You can read more about this in their documentation <a target="_blank" rel="noopener noreferrer" href="https://resilience4j.readme.io/docs/getting-started">here</a></p>
<p>As usual, I have uploaded the code on <a target="_blank" rel="noopener noreferrer" href="https://github.com/amrutprabhu/spring-resilience4j-circuit-breaker-and-retry">GitHub</a>.</p>
<p>I keep exploring and learning new things. If you want to know the latest trends and improve your software development skills, then subscribe to my newsletter below and also follow me on <a target="_blank" rel="noopener noreferrer" href="https://twitter.com/amrutprabhu42">Twitter</a>.</p>
<p>Enjoy!!</p></div></div><hr/></div><footer><div class="text-sm font-medium leading-5 divide-gray-200 xl:divide-y dark:divide-gray-700 xl:col-start-1 xl:row-start-2"><div class="py-4 xl:py-8"><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="m-1 p-1 leading-4 h-6 rounded text-xs uppercase text-white bg-teal-500 hover:bg-teal-600 dark:hover:bg-teal-500 dark:bg-teal-600" href="/tags/spring-boot">Spring Boot</a><a class="m-1 p-1 leading-4 h-6 rounded text-xs uppercase text-white bg-teal-500 hover:bg-teal-600 dark:hover:bg-teal-500 dark:bg-teal-600" href="/tags/java">Java</a><a class="m-1 p-1 leading-4 h-6 rounded text-xs uppercase text-white bg-teal-500 hover:bg-teal-600 dark:hover:bg-teal-500 dark:bg-teal-600" href="/tags/spring-cloud">Spring cloud</a><a class="m-1 p-1 leading-4 h-6 rounded text-xs uppercase text-white bg-teal-500 hover:bg-teal-600 dark:hover:bg-teal-500 dark:bg-teal-600" href="/tags/circuit-breaker">circuit breaker</a><a class="m-1 p-1 leading-4 h-6 rounded text-xs uppercase text-white bg-teal-500 hover:bg-teal-600 dark:hover:bg-teal-500 dark:bg-teal-600" href="/tags/retry">retry</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/spring-boot-spring-cache-with-ehcache-3">Integrate Caching with Spring Cache and Ehcache 3</a></div></div><div><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Next Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/spring-boot-with-kafka-communication">Spring Boot With Kafka Communication</a></div></div></div></div><div class="pt-4 xl:pt-8 xl:mb-8 mb-4"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/">← Back to the articles</a></div><div class="border-4 border-teal-500 rounded-lg p-1"><a target="_blank" rel="noopener noreferrer" href="https://www.copecart.com/products/521411d4/p/techapk42"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA1NCIgaGVpZ2h0PSIyMTAwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIvPg=="/></span><img alt="title" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="object-cover object-center " style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="title" srcSet="/static/images/promotion/testing-spring-boot-applications-masterclass-architecture-524x733.png?imwidth=1080 1x, /static/images/promotion/testing-spring-boot-applications-masterclass-architecture-524x733.png?imwidth=3840 2x" src="/static/images/promotion/testing-spring-boot-applications-masterclass-architecture-524x733.png?imwidth=3840" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="object-cover object-center " loading="lazy"/></noscript></span></a></div></footer></div></div></article></div></main><div class="ml-form-embed" data-account="3117349:p5v1c3m1v8" data-form="4015126:i6h8m5"></div><footer><div class="flex flex-col items-center mt-16"><div class="flex mb-3 space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:contact@refactorfirst.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/amrutprabhu"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/amrut-prabhu-722baa65/"><span class="sr-only">linkedin</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://twitter.com/amrutprabhu42"><span class="sr-only">twitter</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M23.953 4.57a10 10 0 0 1-2.825.775 4.958 4.958 0 0 0 2.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 0 0-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 0 0-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 0 1-2.228-.616v.06a4.923 4.923 0 0 0 3.946 4.827 4.996 4.996 0 0 1-2.212.085 4.936 4.936 0 0 0 4.604 3.417 9.867 9.867 0 0 1-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 0 0 7.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0 0 24 4.59z"></path></svg></a></div><div class="flex mb-2 space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Amrut Prabhu</div><div> • </div><div>© 2023</div><div> • </div><a href="/">RefactorFirst</a><div> • </div><a href="/privacy">Privacy Policy</a></div><br/></div></footer></div></div><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-6xl xl:px-0"><div id="cookie-notice" class="consent_consentname__aF_O7"><br/><br/><p>By clicking “I Accept”, you agree to the storing of cookies on your device to enhance site navigation and analyze site usage</p><br/><br/><div><a id="cookie-notice-accept" class="consent_greenButton__K0FRN">I Accept</a><a href="/privacy">Privacy Policy</a></div><br/><br/><br/></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var d=Object.create;var l=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var i=a=\u003el(a,\"__esModule\",{value:!0});var k=(a,s)=\u003e()=\u003e(s||a((s={exports:{}}).exports,s),s.exports),N=(a,s)=\u003e{i(a);for(var c in s)l(a,c,{get:s[c],enumerable:!0})},g=(a,s,c)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let n of h(s))!u.call(a,n)\u0026\u0026n!==\"default\"\u0026\u0026l(a,n,{get:()=\u003es[n],enumerable:!(c=p(s,n))||c.enumerable});return a},y=a=\u003eg(i(l(a!=null?d(m(a)):{},\"default\",a\u0026\u0026a.__esModule\u0026\u0026\"default\"in a?{get:()=\u003ea.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=k((I,r)=\u003e{r.exports=_jsx_runtime});var x={};N(x,{default:()=\u003ef,frontmatter:()=\u003eb});var e=y(o()),b={title:\"Circuit Breaker And Retry with Spring Cloud Resiliance4j\",author:\"Amrut Prabhu\",categories:\"\",tags:[\"Spring Boot\",\"Java\",\"Spring cloud\",\"circuit breaker\",\"retry\"],image:\"2021/spring-resiliance4j-circuitbreaker-retry/cover.jpg\",\"photo-credits\":\"https://unsplash.com/photos/kK7uPfb2YWU\",\"applaud-link\":\"2021/spring-retry-circuit-breaker.json\",date:\"2021-12-02\",draft:!1,summary:\"In this article, we will be looking into how we can integrate a circuit breaker and a retry mechanism, to handle failures while making synchronous calls to another service.\",imageUrl:\"/static/images/2021/spring-resiliance4j-circuitbreaker-retry/cover.jpg\",actualUrl:\"auto-generated\",customUrl:\"auto-generated\"};function w(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(c,{})})):c();function c(){let n=Object.assign({p:\"p\",h2:\"h2\",a:\"a\",span:\"span\",pre:\"pre\",code:\"code\",div:\"div\",h3:\"h3\",strong:\"strong\",blockquote:\"blockquote\"},a.components),{Image:t}=n;return t||v(\"Image\",!0),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n.p,{children:\"In this article, we will be looking into how we can integrate a circuit breaker and a retry mechanism, to handle failures while making synchronous calls to another service.\"}),`\n`,(0,e.jsxs)(n.h2,{id:\"introduction\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#introduction\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Introduction\"]}),`\n`,(0,e.jsx)(n.p,{children:\"With the growing number of services, services might need to communicate with other servers synchronously and hence become dependent on the upstream service. Any problems while communicating with the upstream services, will propagate to the downstream services.\"}),`\n`,(0,e.jsx)(n.p,{children:\"To protect the services from such problems, we can use some of the patterns to protect the service. So, today we are going to look into two of these, i.e the Circuit Breaker and the Retry mechanism.\"}),`\n`,(0,e.jsx)(n.p,{children:\"Let's first look at the Retry mechanism.\"}),`\n`,(0,e.jsxs)(n.h2,{id:\"integrating-retry\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#integrating-retry\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Integrating Retry\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Let\\u2019s go to \",(0,e.jsx)(n.a,{href:\"https://start.spring.io\",children:\"https://start.spring.io\"}),\" and create a simple spring boot application with the following dependencies.\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-xml\",children:(0,e.jsxs)(n.code,{className:\"language-xml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c\"}),\"dependency\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c\"}),\"groupId\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"org.springframework.cloud\",(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"groupId\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c\"}),\"artifactId\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"spring-cloud-starter-circuitbreaker-resilience4j\",(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"artifactId\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"dependency\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c\"}),\"dependency\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c\"}),\"groupId\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"org.springframework\",(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"groupId\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c\"}),\"artifactId\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"spring-aspects\",(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"artifactId\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsxs)(n.span,{className:\"token tag\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"dependency\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"Along with the circuit-breaker starter dependency, we need the spring aspects dependencies, as the retry and circuit breaker mechanism works using the Spring AOP concept.\"}),`\n`,(0,e.jsx)(n.p,{children:\"Next, we are going to add a service class that will make a REST call to an endpoint using a RestTemplate.\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-java\",children:(0,e.jsxs)(n.code,{className:\"language-java code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token annotation punctuation\",children:\"@org.springframework.stereotype.Service\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"class\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"Service\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token annotation punctuation\",children:\"@Value\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"${service2.url:http://localhost:6060/service2}\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"String\"}),\" serviceUrl\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token annotation punctuation\",children:\"@Retry\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"name \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"myRetry\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" fallbackMethod \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"fallback\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"String\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"fetchData\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"System\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"out\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"println\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\" Making a request to \"'}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" serviceUrl \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\" at :\"'}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"LocalDateTime\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"now\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"RestTemplate\"}),\" restTemplate \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"RestTemplate\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" restTemplate\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"getForObject\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"serviceUrl\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"String\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"class\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"String\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"fallback\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token class-name\",children:\"Exception\"}),\" e\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"fallback value\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"As you can see, we have the retry annotation on this method and the name of the fallback method if the retry count runs out. We will call the \",(0,e.jsx)(n.code,{children:\"fetchData\"}),\" method from a controller which just has a simple get mapping.\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-java\",children:(0,e.jsxs)(n.code,{className:\"language-java code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token annotation punctuation\",children:\"@RestController\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"class\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"Controller\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token annotation punctuation\",children:\"@Autowired\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"Service\"}),\" service\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token annotation punctuation\",children:\"@GetMapping\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"/\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"String\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"getValues\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" service\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"fetchData\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"Now, let's look at the retry configuration.\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"language-yaml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"resilience4j\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"retry\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"instances\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"myRetry\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"max-attempts\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"wait-duration\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` 5s\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"In this, we are creating the most straightforward configuration of retrying only 3 times and the interval between retries is 5 secs.\"}),`\n`,(0,e.jsx)(n.p,{children:\"With this let\\u2019s start the application and make a call to the get endpoint.\"}),`\n`,(0,e.jsx)(n.div,{children:(0,e.jsx)(t,{alt:\"curl request fall back\",src:\"/static/images/2021/spring-resiliance4j-circuitbreaker-retry/curl-request-fallback.png\",width:\"839\",height:\"70\"})}),`\n`,(0,e.jsx)(n.div,{children:(0,e.jsx)(t,{alt:\"retry fixed rate\",src:\"/static/images/2021/spring-resiliance4j-circuitbreaker-retry/first-retry-5-secs-diff.png\",width:\"1040\",height:\"104\"})}),`\n`,(0,e.jsx)(n.p,{children:\"This was retrying after a fixed rate of 5 secs.\"}),`\n`,(0,e.jsxs)(n.h3,{id:\"exponential-retries\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#exponential-retries\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Exponential Retries\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Now, It may happen that retrying after a fixed time could cause the upstream service to further not respond ( probably it\\u2019s already overwhelmed with many requests). In this case, we can provide an exponential back-off mechanism.\"}),`\n`,(0,e.jsx)(n.p,{children:\"Let's add this config.\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"language-yaml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"resilience4j\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"retry\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"instances\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"myRetry\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"max-attempts\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"wait-duration\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` 5s\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"enable-exponential-backoff\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"exponential-backoff-multiplier\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),`\n`]})]})}),`\n`,(0,e.jsx)(n.p,{children:\"The exponent backoff works in the following way:\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-shell\",children:(0,e.jsx)(n.code,{className:\"language-shell code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"wait-duration * \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"exponential-backoff-multiplier ^ \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"retry iteration count\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"))\"}),`\n`]})})}),`\n`,(0,e.jsx)(n.p,{children:\"So with the above configuration, The reties will occur at the following times.\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-groovy\",children:(0,e.jsxs)(n.code,{className:\"language-groovy code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"1st Retry  \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),\" 5s \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"^\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" after \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),` seconds\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"2nd Retry  \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),\" 5s \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"^\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" after \",(0,e.jsx)(n.span,{className:\"token number\",children:\"10\"}),` seconds\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"3rd Retry  \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),\" 5s \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"^\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" after \",(0,e.jsx)(n.span,{className:\"token number\",children:\"20\"}),` seconds\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"..\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"..\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"nTh Retry \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),\" 5s \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"^\"}),`n\n`]})]})}),`\n`,(0,e.jsx)(n.div,{children:(0,e.jsx)(t,{alt:\"exponential retry\",src:\"/static/images/2021/spring-resiliance4j-circuitbreaker-retry/retry-with-exponential.png\",width:\"1118\",height:\"112\"})}),`\n`,(0,e.jsxs)(n.h3,{id:\"conditional-retry-on-exceptions\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#conditional-retry-on-exceptions\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Conditional Retry on Exceptions\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Let's consider there may be certain exceptions you want to retry and some exceptions you don't want to retry.\"}),`\n`,(0,e.jsx)(n.p,{children:\"For example, when we send a bad request, no matter the number of retries, we will always get the same error. In this case, we would not want to retry. But for say 404 errors, we would want to retry ( probably the service is temporarily unavailable).\"}),`\n`,(0,e.jsx)(n.p,{children:\"In such cases, we can configure for which exception type we should retry or not. To do this we need to add the following config properties.\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"language-yaml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"resilience4j\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"retry\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"instances\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"myRetry\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"max-attempts\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"wait-duration\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` 5s\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"enable-exponential-backoff\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"exponential-backoff-multiplier\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"retry-exceptions\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` org.springframework.web.client.RestClientException\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"ignore-exceptions\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` com.amrut.prabhu.IgnoreException\n`]})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Just as an example I have declared that I do not want to retry when an exception of type \",(0,e.jsx)(n.code,{children:\"IgnoreException\"}),\" is thrown.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Now, these were some of the configuration properties for the Resilience4J Retry mechanism.\"}),`\n`,(0,e.jsx)(n.p,{children:\"Let\\u2019s look at yet another concept called the Circuit Breaker.\"}),`\n`,(0,e.jsxs)(n.h2,{id:\"integrating-a-circuit-breaker\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#integrating-a-circuit-breaker\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Integrating a Circuit Breaker\"]}),`\n`,(0,e.jsx)(n.p,{children:\"A circuit breaker is a mechanism that allows the application to protect itself from unreliable downstream services. This prevents cascading failures to be propagated throughout the system and helps to build fault-tolerant and reliable services.\"}),`\n`,(0,e.jsx)(n.p,{children:\"The support for the circuit breaker is already present in the dependency we added so let\\u2019s make use of it.\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-java\",children:(0,e.jsxs)(n.code,{className:\"language-java code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token annotation punctuation\",children:\"@CircuitBreaker\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"name \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"myCircuitBreaker\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" fallbackMethod \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"fallback\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token annotation punctuation\",children:\"@Retry\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"name \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"myRetry\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"String\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"fetchData\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"System\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"out\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"println\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\" Making a request to \"'}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" serviceUrl \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\" at :\"'}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"LocalDateTime\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"now\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"RestTemplate\"}),\" restTemplate \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"RestTemplate\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" restTemplate\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"getForObject\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"serviceUrl\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"String\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"class\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Note:\"}),\" Carefully notice I have removed the fallback method from the retry annotation. Because I want the circuit breaker to take over when the retries have exhausted.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Let\\u2019s configure the circuit breaker.\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"language-yaml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"resilience4j\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"retry\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"instances\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"myRetry\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"max-attempts\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"wait-duration\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` 5s\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"enable-exponential-backoff\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"exponential-backoff-multiplier\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"retry-exceptions\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"         \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` org.springframework.web.client.RestClientException\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"ignore-exceptions\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"         \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` com.amrut.prabhu.IgnoreException\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"circuitbreaker\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"  \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"instances\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"myCircuitBreaker\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"       \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"wait-duration-in-open-state\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` 1m\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"       \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"permitted-number-of-calls-in-half-open-state\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"       \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"sliding-window-type\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" count\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`based\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"       \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"sliding-window-size\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"       \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"minimum-number-of-calls\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"       \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"slow-call-duration-threshold\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` 10s\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"       \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"slow-call-rate-threshold\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"60\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"       \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"failure-rate-threshold\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"60\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.h3,{id:\"understanding-the-circuit-breaker-config\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#understanding-the-circuit-breaker-config\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Understanding the Circuit Breaker Config\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Here, I am using a count-based sliding window, wherein the window size is of 5 events, and the failure and slowness threshold rate is 60%.\"}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"Now, what does this sliding window mean?\"}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"It means that we would consider a set of 5 consecutive events ( success or failures), to determine if the circuit breaker should transition to an OPEN or CLOSED state.\"}),`\n`,(0,e.jsx)(n.p,{children:\"The term OPEN state means the circuit breaker is activated thereby not allowing calls to be made to the upstream service.\"}),`\n`,(0,e.jsx)(n.p,{children:\"Now, in the above config, if in 5 calls, 60% of the calls fail or are slow ( i.e at least 3 calls), then the circuit breaker would move to the OPEN state. Once the circuit breaker moves to the OPEN state, it would wait in this state for 1 minute before moving to a HALF-OPEN state.\"}),`\n`,(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsx)(n.p,{children:\"Now, what is this HALF-OPEN state?\"}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"This state is like an evaluation state, where we check based on a limited number of permitted calls if the circuit breaker moves to either OPEN or CLOSED state. Based on the permitted number of calls, if the number of slow or failures exceeds the slowness or failure threshold then the circuit breaker moves back to the OPEN state or else moves it to the CLOSED state.\"}),`\n`,(0,e.jsx)(n.p,{children:\"For example, In the above config, since we have set the number of permitted calls in HALF_OPEN state as 3, at least 2 calls need to succeed in order for the circuit breaker to move back to the CLOSED state and allow the calls to the upstream server.\"}),`\n`,(0,e.jsx)(n.div,{children:(0,e.jsx)(t,{alt:\"\",src:\"/static/images/2021/spring-resiliance4j-circuitbreaker-retry/circuit-breaker-state-transition.png\",width:\"542\",height:\"418\"})}),`\n`,(0,e.jsxs)(n.h2,{id:\"circuit-breaker-and-retry-config-together\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#circuit-breaker-and-retry-config-together\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Circuit Breaker and Retry Config Together\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Now with the above config, let\\u2019s start the application and make a request to the endpoint.\"}),`\n`,(0,e.jsx)(n.div,{children:(0,e.jsx)(t,{alt:\"fallback curl request\",src:\"/static/images/2021/spring-resiliance4j-circuitbreaker-retry/curl-request-fallback.png\",width:\"839\",height:\"70\"})}),`\n`,(0,e.jsx)(n.div,{children:(0,e.jsx)(t,{alt:\"no retry with circuit breaker\",src:\"/static/images/2021/spring-resiliance4j-circuitbreaker-retry/no-retry-with-circuit-breaker.png\",width:\"1193\",height:\"50\"})}),`\n`,(0,e.jsx)(n.p,{children:\"On making a request we see that it only tried once and directly returned us the fallback value. This is because the circuit breaker fallback method was called directly and the retry was not triggered. The reason for this is the order in which the spring aspects handling the two mechanisms are arranged.\"}),`\n`,(0,e.jsxs)(n.h3,{id:\"circuit-breaker-and-retry-aspects-order\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#circuit-breaker-and-retry-aspects-order\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Circuit Breaker and Retry Aspects Order\"]}),`\n`,(0,e.jsx)(n.p,{children:\"As the implementation of the circuit breaker and retry mechanism work by making use of spring\\u2019s method-based AOP mechanism, the aspects handling the two different mechanisms have a certain order.\"}),`\n`,(0,e.jsx)(n.p,{children:\"By default, the retry mechanism has lower priority and hence it warps around the circuit breaker aspect.\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{className:\"code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:` Retry  ( Circuit Breaker ( function ) )\n`})})}),`\n`,(0,e.jsx)(n.p,{children:\"Now to change this, we can add an \\u201Caspect order\\u201D property to define the order as shown below.\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"language-yaml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"resilience4j\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"retry\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"retry-aspect-order\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"instances\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"myRetry\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"max-attempts\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"wait-duration\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` 5s\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"enable-exponential-backoff\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"exponential-backoff-multiplier\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"retry-exceptions\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` org.springframework.web.client.RestClientException\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"ignore-exceptions\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` com.amrut.prabhu.IgnoreException\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"circuitbreaker\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"circuit-breaker-aspect-order\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"instances\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"myCircuitBreaker\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"wait-duration-in-open-state\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` 1m\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"permitted-number-of-calls-in-half-open-state\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"sliding-window-type\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" count\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`based\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"sliding-window-size\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"minimum-number-of-calls\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"slow-call-duration-threshold\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` 10s\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"slow-call-rate-threshold\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"60\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token key atrule\",children:\"failure-rate-threshold\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"60\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.p,{children:[\"The higher the order value, the higher is the priority. You can read about the default priority order in the documentation \",(0,e.jsx)(n.a,{href:\"https://resilience4j.readme.io/docs/getting-started-3#aspect-order\",children:\"here\"}),\".\"]}),`\n`,(0,e.jsx)(n.p,{children:\"With this when we run the application, we get the following output.\"}),`\n`,(0,e.jsx)(n.div,{children:(0,e.jsx)(t,{alt:\"retry with circuit breaker\",src:\"/static/images/2021/spring-resiliance4j-circuitbreaker-retry/retry-with-circuit-breaker.png\",width:\"924\",height:\"89\"})}),`\n`,(0,e.jsx)(n.p,{children:\"With this, the 3 retries happen and then the circuit breaker aspect would take over.\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"If you carefully want to understand the working of the circuit breaker and retry mechanism, I have written an integration test which you can refer to \",(0,e.jsx)(n.a,{href:\"https://github.com/amrutprabhu/spring-resilience4j-circuit-breaker-and-retry/blob/main/spring-boot-with-circuit-breaker-and-retry/src/test/java/com/amrut/prabhu/CircuitBreakerAndRetryTest.java\",children:\"here\"})]}),`\n`,(0,e.jsxs)(n.h3,{id:\"conclusion\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#conclusion\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Conclusion\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"With this, we just saw how we can integrate a Circuit Breaker and a Retry mechanism in a spring boot application. Similarly, we can integrate rate limiter, bulkhead, etc. You can read more about this in their documentation \",(0,e.jsx)(n.a,{href:\"https://resilience4j.readme.io/docs/getting-started\",children:\"here\"})]}),`\n`,(0,e.jsxs)(n.p,{children:[\"As usual, I have uploaded the code on \",(0,e.jsx)(n.a,{href:\"https://github.com/amrutprabhu/spring-resilience4j-circuit-breaker-and-retry\",children:\"GitHub\"}),\".\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"I keep exploring and learning new things. If you want to know the latest trends and improve your software development skills, then subscribe to my newsletter below and also follow me on \",(0,e.jsx)(n.a,{href:\"https://twitter.com/amrutprabhu42\",children:\"Twitter\"}),\".\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Enjoy!!\"})]})}}var f=w;function v(a,s){throw new Error(\"Expected \"+(s?\"component\":\"object\")+\" `\"+a+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return x;})();\n;return Component;","toc":[{"value":"Introduction","url":"#introduction","depth":2},{"value":"Integrating Retry","url":"#integrating-retry","depth":2},{"value":"Exponential Retries","url":"#exponential-retries","depth":3},{"value":"Conditional Retry on Exceptions","url":"#conditional-retry-on-exceptions","depth":3},{"value":"Integrating a Circuit Breaker","url":"#integrating-a-circuit-breaker","depth":2},{"value":"Understanding the Circuit Breaker Config","url":"#understanding-the-circuit-breaker-config","depth":3},{"value":"Circuit Breaker and Retry Config Together","url":"#circuit-breaker-and-retry-config-together","depth":2},{"value":"Circuit Breaker and Retry Aspects Order","url":"#circuit-breaker-and-retry-aspects-order","depth":3},{"value":"Conclusion","url":"#conclusion","depth":3}],"frontMatter":{"readingTime":{"text":"11 min read","minutes":10.71,"time":642600,"words":2142},"slug":"2021/spring-cloud-resiliance4j-circuitbreaker-and-retry","fileName":"2021/spring-cloud-resiliance4j-circuitbreaker-and-retry.md","title":"Circuit Breaker And Retry with Spring Cloud Resiliance4j","author":"Amrut Prabhu","categories":"","tags":["Spring Boot","Java","Spring cloud","circuit breaker","retry"],"image":"2021/spring-resiliance4j-circuitbreaker-retry/cover.jpg","photo-credits":"https://unsplash.com/photos/kK7uPfb2YWU","applaud-link":"2021/spring-retry-circuit-breaker.json","date":"2021-12-02T00:00:00.000Z","draft":false,"summary":"In this article, we will be looking into how we can integrate a circuit breaker and a retry mechanism, to handle failures while making synchronous calls to another service.","imageUrl":"/static/images/2021/spring-resiliance4j-circuitbreaker-retry/cover.jpg","actualUrl":"2021/spring-cloud-resiliance4j-circuitbreaker-and-retry","customUrl":"spring-cloud-resiliance4j-circuitbreaker-and-retry"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.875,"time":52500,"words":175},"slug":["default"],"fileName":"default.md","name":"Amrut Prabhu","avatar":"/static/images/avatar-small.jpg","avatarBig":"/static/images/avatar-big.jpg","occupation":"Staff Engineer","company":"Personal","email":"contact@refactorfirst.com","twitter":"https://twitter.com/amrutprabhu42","linkedin":"https://www.linkedin.com/in/amrut-prabhu-722baa65/","github":"https://github.com/amrutprabhu","customUrl":"default","actualUrl":"default","date":null}],"prev":{"title":"Integrate Caching with Spring Cache and Ehcache 3","author":"Amrut Prabhu","categories":"","tags":["Spring Boot","Java","Spring cache","ehcache 3","Jcache"],"image":"2021/spring-cache-ehcache-3/cover.jpg","photo-credits":"","applaud-link":"2021/spring-cache-ehcache-3.json","date":"2021-11-02T00:00:00.000Z","draft":false,"summary":"In this article, we will look into some Spring Cache concepts and then integrate Ehcache 3.","imageUrl":"/static/images/2021/spring-cache-ehcache-3/cover.jpg","actualUrl":"2021/spring-boot-spring-cache-with-ehcache-3","customUrl":"spring-boot-spring-cache-with-ehcache-3","slug":"spring-boot-spring-cache-with-ehcache-3"},"next":{"title":"Spring Boot With Kafka Communication","author":"Amrut Prabhu","categories":"","tags":["Spring Boot","Java","Kafka","producer","consumer","scheduled"],"image":"2021/spring-boot-kafka-communication/cover.jpg","photo-credits":null,"applaud-link":"2021/spring-boot-kafka-communication.json","date":"2021-12-09T00:00:00.000Z","draft":false,"summary":"In this, we will be looking into how we can publish and subscribe to a Kafka topic using Spring Kafka","imageUrl":"/static/images/2021/spring-boot-kafka-communication/cover.jpg","actualUrl":"2021/spring-boot-with-kafka-communication","customUrl":"spring-boot-with-kafka-communication","slug":"spring-boot-with-kafka-communication"}},"__N_SSG":true},"page":"/[slug]","query":{"slug":"spring-cloud-resiliance4j-circuitbreaker-and-retry"},"buildId":"_mDO0DwDYqH9QlMpUH7QG","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>